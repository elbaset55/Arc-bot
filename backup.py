import logging
import random
import sqlite3
from datetime import datetime, timedelta
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup, ReplyKeyboardMarkup, ReplyKeyboardRemove
from telegram.ext import Application, CommandHandler, MessageHandler, ConversationHandler, ContextTypes, filters, CallbackQueryHandler

# Enable logging
logging.basicConfig(format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO)
logger = logging.getLogger(__name__)

# Bot token
TELEGRAM_BOT_TOKEN = '6817603176:AAHcvgFyPvaGNrF-8lO_8889kAhNZrXbW84'

# Conversation states
(CHOOSING, BOOK_RECOMMENDATION, READING_PROGRESS, QUIZ, BOOK_REVIEW, 
 READING_GROUP, CHALLENGE, CREATING_GROUP, JOINING_GROUP, SUMMARIZE_BOOK) = range(10)

# Initialize SQLite database
conn = sqlite3.connect('reading_challenge.db')
c = conn.cursor()

# Create tables
def init_db():
    c.executescript('''
    CREATE TABLE IF NOT EXISTS users
        (id INTEGER PRIMARY KEY, username TEXT, current_book TEXT);
    CREATE TABLE IF NOT EXISTS reading_progress
        (user_id INTEGER, date TEXT, pages INTEGER);
    CREATE TABLE IF NOT EXISTS book_reviews
        (user_id INTEGER, book TEXT, review TEXT);
    CREATE TABLE IF NOT EXISTS reading_groups
        (id INTEGER PRIMARY KEY, name TEXT);
    CREATE TABLE IF NOT EXISTS group_members
        (group_id INTEGER, user_id INTEGER);
    CREATE TABLE IF NOT EXISTS challenges
        (id INTEGER PRIMARY KEY, user_id INTEGER, challenge_type TEXT, 
         start_date TEXT, end_date TEXT, goal INTEGER, progress INTEGER);
    ''')
    conn.commit()

init_db()

# Book data
books = {
    'ุงุจุชุฏุงุฆูุฉ': [
        {"title": "ูุตุต ุงูุฃุทูุงู", "author": "ูุงูู ูููุงูู", "image": "https://example.com/kamil_kilani_stories.jpg"},
        {"title": "ุณูุณูุฉ ุงูููุชุจุฉ ุงูุฎุถุฑุงุก", "author": "ุฏุงุฑ ุงููุนุงุฑู", "image": "https://example.com/green_library_series.jpg"},
        {"title": "ุญูุงูุงุช ุฌุญุง", "author": "ูุญููุฏ ูุงุณู", "image": "https://example.com/joha_stories.jpg"},
        {"title": "ุงูุฃููุฑ ุงูุตุบูุฑ", "author": "ุฃูุทูุงู ุฏู ุณุงูุช ุฅูุฒูุจูุฑู", "image": "https://example.com/little_prince.jpg"},
        {"title": "ููููุฉ ูุฏููุฉ", "author": "ุงุจู ุงููููุน", "image": "https://example.com/kalila_wadimna.jpg"},
        {"title": "ุญูุงูุงุช ุนุงูููุฉ", "author": "ูุฌููุนุฉ ูู ุงููุคูููู", "image": "https://example.com/global_tales.jpg"},
        {"title": "ูุตุต ุงูุฃูุจูุงุก", "author": "ุงุจู ูุซูุฑ", "image": "https://example.com/prophets_stories.jpg"},
        {"title": "ุณูุณูุฉ ุนุงูู ุงููุนุฑูุฉ ููุฃุทูุงู", "author": "ุฏุงุฑ ุงูุดุฑูู", "image": "https://example.com/knowledge_world_kids.jpg"},
        {"title": "ุฃูู ูููุฉ ููููุฉ ููุฃุทูุงู", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/alf_leila_wal_leila_kids.jpg"},
        {"title": "ุญูุงูุงุช ูู ุงูุชุฑุงุซ ุงูุดุนุจู", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/folk_tales.jpg"},
        {"title": "ุงููุฑุขู ุงููุฑูู ููุฃุทูุงู", "author": "ุงููุฑุขู ุงููุฑูู", "image": "https://example.com/quran_kids.jpg"},
        {"title": "ุชุนููู ุงููุบุฉ ุงูุนุฑุจูุฉ ููุฃุทูุงู", "author": "ูุฌููุนุฉ ูู ุงููุคูููู", "image": "https://example.com/arabic_language_teaching.jpg"},
        {"title": "ุณูุณูุฉ ุงูููุชุจุฉ ุงูุญุฏูุซุฉ ููุฃุทูุงู", "author": "ุฏุงุฑ ุงููุนุงุฑู", "image": "https://example.com/modern_library_series.jpg"},
        {"title": "ูููุจ ุงูุฃุฑุถ", "author": "ูุฌููุนุฉ ูู ุงููุคูููู", "image": "https://example.com/planet_earth.jpg"},
        {"title": "ุงููุญูุฉ ุงูุนุงููุฉ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/working_bee.jpg"},
        {"title": "ุงููููุฉ ูุงูุฌุฑุงุฏุฉ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/ant_grasshopper.jpg"},
        {"title": "ุงูุณูุญูุงุฉ ูุงูุฃุฑูุจ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/tortoise_hare.jpg"},
        {"title": "ุณูุณูุฉ ุงูููุชุจุฉ ุงูุตูุฑุงุก", "author": "ุฏุงุฑ ุงููุนุงุฑู", "image": "https://example.com/yellow_library_series.jpg"},
        {"title": "ุณูุณูุฉ ุงููุชุจ ุงููุตูุฑุฉ", "author": "ูุฌููุนุฉ ูู ุงููุคูููู", "image": "https://example.com/picture_books.jpg"},
        {"title": "ุชูุชุฉ ูุญุฏูุชุฉ", "author": "ูุฌููุนุฉ ูู ุงููุคูููู", "image": "https://example.com/tuta_haduta.jpg"},
        {"title": "ุญุฏููุฉ ุงูุญุฑูู", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/alphabet_garden.jpg"},
        {"title": "ูุบุงูุฑุงุช ุณูุฏุจุงุฏ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/sindbad_adventures.jpg"},
        {"title": "ูููู ูุงูุฐุฆุจ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/laila_wolf.jpg"},
        {"title": "ุนูุงุก ุงูุฏูู ูุงููุตุจุงุญ ุงูุณุญุฑู", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/aladdin_lamp.jpg"},
        {"title": "ุจูููููู", "author": "ูุงุฑูู ููููุฏู", "image": "https://example.com/pinocchio.jpg"},
        {"title": "ูุบุงูุฑุงุช ุชูู ุณููุฑ", "author": "ูุงุฑู ุชููู", "image": "https://example.com/tom_sawyer_adventures.jpg"},
        {"title": "ูุบุงูุฑุงุช ูุงูุณู ูุบุฑูุชู", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/hansel_gretel_adventures.jpg"},
        {"title": "ุงูุฃุณุฏ ูุงููุฃุฑ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/lion_mouse.jpg"},
        {"title": "ุงูููู ุงูุทูุจ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/good_elephant.jpg"},
        {"title": "ุงูุณููุฉ ุงูุตุบูุฑุฉ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/little_fish.jpg"},
        {"title": "ุงูุณูุฏุฑููุง", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/cinderella.jpg"}
    ]
,
    'ุงุนุฏุงุฏูุฉ': [
        {"title": "ุงูุฃูุงู", "author": "ุทู ุญุณูู", "image": "https://example.com/al_ayam.jpg"},
        {"title": "ุญู ุจู ููุธุงู", "author": "ุงุจู ุทููู", "image": "https://example.com/hay_ibn_yakzan.jpg"},
        {"title": "ุฑุฌุงู ูู ุงูุดูุณ", "author": "ุบุณุงู ูููุงูู", "image": "https://example.com/rijal_fi_shams.jpg"},
        {"title": "ุงูุดุงุนุฑ", "author": "ูุตุทูู ูุทูู ุงููููููุทู", "image": "https://example.com/al_shair.jpg"},
        {"title": "ุงููุถููุฉ", "author": "ูุตุทูู ูุทูู ุงููููููุทู", "image": "https://example.com/al_fadila.jpg"},
        {"title": "ุงููุธุฑุงุช", "author": "ูุตุทูู ูุทูู ุงููููููุทู", "image": "https://example.com/al_nazrat.jpg"},
        {"title": "ููุฏูู ุฃู ูุงุดู", "author": "ูุญูู ุญูู", "image": "https://example.com/kandeel_om_hashim.jpg"},
        {"title": "ุงูุทูู ูุงูุฃุณูุฑุฉ", "author": "ูุญูู ุงูุทุงูุฑ ุนุจุฏุงููู", "image": "https://example.com/al_touk_al_aswera.jpg"},
        {"title": "ุนูุฏุฉ ุงูุฑูุญ", "author": "ุชูููู ุงูุญููู", "image": "https://example.com/awdat_al_roh.jpg"},
        {"title": "ุฃููุงุฏ ุญุงุฑุชูุง", "author": "ูุฌูุจ ูุญููุธ", "image": "https://example.com/awlad_haratna.jpg"},
        {"title": "ุฒูุงู ุงููุฏู", "author": "ูุฌูุจ ูุญููุธ", "image": "https://example.com/ziqaq_al_madaq.jpg"},
        {"title": "ุงููุต ูุงูููุงุจ", "author": "ูุฌูุจ ูุญููุธ", "image": "https://example.com/al_liss_wal_kelab.jpg"},
        {"title": "ุนุตุงููุฑ ุงูููู", "author": "ุฅุจุฑุงููู ุฃุตูุงู", "image": "https://example.com/asafeer_al_neel.jpg"},
        {"title": "ุงูุดุญุงุฐ", "author": "ูุฌูุจ ูุญููุธ", "image": "https://example.com/al_shahaz.jpg"},
        {"title": "ุฏุนุจูู", "author": "ููุณู ุฅุฏุฑูุณ", "image": "https://example.com/daabul.jpg"},
        {"title": "ุงููุฑุขู ุงููุฑูู", "author": "ุงููุฑุขู ุงููุฑูู", "image": "https://example.com/quran.jpg"},
        {"title": "ุงูุฑุญูู ุงููุฎุชูู", "author": "ุตูู ุงูุฑุญูู ุงููุจุงุฑูููุฑู", "image": "https://example.com/raheeq_makhtoom.jpg"},
        {"title": "ุงูุจุฏุงูุฉ ูุงูููุงูุฉ", "author": "ุงุจู ูุซูุฑ", "image": "https://example.com/bidaya_nihaya.jpg"},
        {"title": "ุงููุนููุงุช ุงูุณุจุน", "author": "ุฃุนุดู ููุณ", "image": "https://example.com/mualaqat_saba.jpg"},
        {"title": "ุงูุจูุงู ูุงูุชุจููู", "author": "ุงูุฌุงุญุธ", "image": "https://example.com/al_bayan_tabeen.jpg"},
        {"title": "ุงูุนูุฏ ุงููุฑูุฏ", "author": "ุงุจู ุนุจุฏ ุฑุจู", "image": "https://example.com/al_aqd_al_fareed.jpg"},
        {"title": "ููููุฉ ูุฏููุฉ", "author": "ุงุจู ุงููููุน", "image": "https://example.com/kalila_wadimna.jpg"},
        {"title": "ุงูุฃุฏุจ ุงููุจูุฑ", "author": "ุงุจู ุงููููุน", "image": "https://example.com/al_adab_alkabir.jpg"},
        {"title": "ุงูุฃุฏุจ ุงูุตุบูุฑ", "author": "ุงุจู ุงููููุน", "image": "https://example.com/al_adab_alsaghir.jpg"},
        {"title": "ุณูุฑุฉ ุนูุชุฑุฉ ุจู ุดุฏุงุฏ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/antaraa.jpg"},
        {"title": "ุฏููุงู ุงูุฑุฆ ุงูููุณ", "author": "ุงูุฑุค ุงูููุณ", "image": "https://example.com/diwan_imra_alqays.jpg"},
        {"title": "ุฏููุงู ุงููุชูุจู", "author": "ุงููุชูุจู", "image": "https://example.com/diwan_mutanabbi.jpg"},
        {"title": "ุงูุดุนุฑ ูุงูุดุนุฑุงุก", "author": "ุงุจู ูุชูุจุฉ", "image": "https://example.com/shaar_wal_shura.jpg"},
        {"title": "ุงููุฒูููุงุช", "author": "ุฃุจู ุงูุนูุงุก ุงููุนุฑู", "image": "https://example.com/al_luzumiyat.jpg"},
        {"title": "ุฃูู ูููุฉ ููููุฉ", "author": "ุบูุฑ ูุนุฑูู", "image": "https://example.com/alf_leila_wal_leila.jpg"},
        {"title": "ุงูุฃุบุงูู", "author": "ุฃุจู ุงููุฑุฌ ุงูุฃุตููุงูู", "image": "https://example.com/al_aghani.jpg"}
    ],
    'ุซุงูููุฉ': [
    {"title": "ุงูุฃุฏุจ ุงูุนุฑุจู ุงููุนุงุตุฑ", "author": "ุทู ุญุณูู", "image": "https://example.com/modern_arabic_lit.jpg"},
    {"title": "ุงูุฃุบุงูู", "author": "ุฃุจู ุงููุฑุฌ ุงูุฃุตููุงูู", "image": "https://example.com/alaghaani.jpg"},
    {"title": "ุงููุนููุงุช ุงูุณุจุน", "author": "ุญูุงุณุฉ ุงูุจุญุชุฑู", "image": "https://example.com/seven_mualaqat.jpg"},
    {"title": "ุงูุฅููุงุฐุฉ", "author": "ููููุฑูุณ", "image": "https://example.com/iliad.jpg"},
    {"title": "ุงูุฃูุฏูุณุฉ", "author": "ููููุฑูุณ", "image": "https://example.com/odyssey.jpg"},
    {"title": "ุฏูู ููุดูุช", "author": "ููุบูู ุฏู ุซูุฑุจุงูุชุณ", "image": "https://example.com/don_quixote.jpg"},
    {"title": "ุงูุขููุฉ ุนุทุดู", "author": "ุฃูุงุชูู ูุฑุงูุณ", "image": "https://example.com/gods_thirsty.jpg"},
    {"title": "ุงูุจุฎูุงุก", "author": "ุงูุฌุงุญุธ", "image": "https://example.com/albukhala.jpg"},
    {"title": "ูุฌูุน ุงูุจุญุฑูู", "author": "ุงูุดุฑูู ุงููุฑุชุถู", "image": "https://example.com/majmaa_bahrain.jpg"},
    {"title": "ุทูู ุงูุญูุงูุฉ", "author": "ุงุจู ุญุฒู ุงูุฃูุฏูุณู", "image": "https://example.com/taq_el_hamama.jpg"},
    {"title": "ููููุฉ ูุฏููุฉ", "author": "ุงุจู ุงููููุน", "image": "https://example.com/kalila_dimna.jpg"},
    {"title": "ููุฌ ุงูุจูุงุบุฉ", "author": "ุงูุฅูุงู ุนูู ุจู ุฃุจู ุทุงูุจ", "image": "https://example.com/nahj_balagha.jpg"},
    {"title": "ุฑุณุงุฆู ุฅุฎูุงู ุงูุตูุง", "author": "ุฅุฎูุงู ุงูุตูุง", "image": "https://example.com/rasael_ikhwan.jpg"},
    {"title": "ุงูุจูุงู ูุงูุชุจููู", "author": "ุงูุฌุงุญุธ", "image": "https://example.com/alquran_azim.jpg"},
    {"title": "ุฃูู ูููุฉ ููููุฉ", "author": "ูุฌููุนุฉ ูุคูููู", "image": "https://example.com/1001_nights.jpg"},
    {"title": "ุงููุฌูุฏูุฉ", "author": "ุฌุงู ุจูู ุณุงุฑุชุฑ", "image": "https://example.com/existentialism.jpg"},
    {"title": "ูู ุงูุชุธุงุฑ ุบูุฏู", "author": "ุตูููู ุจูููุช", "image": "https://example.com/waiting_godot.jpg"},
    {"title": "ุชุงุฌุฑ ุงูุจูุฏููุฉ", "author": "ููููุงู ุดูุณุจูุฑ", "image": "https://example.com/merchant_venice.jpg"},
    {"title": "ุงูุงุนุชุฑุงูุงุช", "author": "ุฌุงู ุฌุงู ุฑูุณู", "image": "https://example.com/confessions.jpg"},
    {"title": "ุงูุฃููุฑ", "author": "ูููููู ูููุงูููู", "image": "https://example.com/the_prince.jpg"},
    {"title": "ุฑูุญ ุงูููุงููู", "author": "ูููุชุณููู", "image": "https://example.com/spirit_of_laws.jpg"},
    {"title": "ุซูุฑุฉ 1789", "author": "ุฃูุจูุฑ ุณูุจูู", "image": "https://example.com/revolution_1789.jpg"},
    {"title": "ููุณูุนุฉ ุงูููุณูุฉ", "author": "ุนุจุฏ ุงูุฑุญูู ุจุฏูู", "image": "https://example.com/philosophy_encyclopedia.jpg"},
    {"title": "ุงูุณูุงุณุฉ", "author": "ุฃุฑุณุทู", "image": "https://example.com/aristotle_politics.jpg"},
    {"title": "ุชุงุฑูุฎ ุงูููุณูุฉ ุงูุบุฑุจูุฉ", "author": "ุจุฑุชุฑุงูุฏ ุฑุงุณู", "image": "https://example.com/history_of_western_philosophy.jpg"},
    {"title": "ุงููุฌูุฏ ูุงูุนุฏู", "author": "ุฌุงู ุจูู ุณุงุฑุชุฑ", "image": "https://example.com/being_and_nothingness.jpg"},
    {"title": "ุงูุฌูููุฑูุฉ", "author": "ุฃููุงุทูู", "image": "https://example.com/republic.jpg"},
    {"title": "ุงูุฅูุณุงู ุฐูู ุงููุฌููู", "author": "ุฃูููุณุณ ูุงุฑูู", "image": "https://example.com/man_the_unknown.jpg"},
    {"title": "ููุฏ ุงูุนูู ุงููุญุถ", "author": "ุฅููุงูููู ูุงูุช", "image": "https://example.com/critique_of_pure_reason.jpg"},
    {"title": "ุนุงูู ุตููู", "author": "ุฌูุณุชุงูู ุบุงุฑุฏุฑ", "image": "https://example.com/sophies_world.jpg"}]

}

# Quiz questions
questions = [
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุฃูู ูููุฉ ููููุฉ'ุ",
        "options": ["ูุฌููู", "ูุฌูุจ ูุญููุธ", "ุทู ุญุณูู", "ุฃุญูุฏ ุดููู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุจุฎูุงุก'ุ",
        "options": ["ุงูุฌุงุญุธ", "ุงุจู ุงููููุน", "ุงุจู ุฑุดุฏ", "ุงุจู ุฎูุฏูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฃูุงู'ุ",
        "options": ["ุทู ุญุณูู", "ุนุจุงุณ ูุญููุฏ ุงูุนูุงุฏ", "ูุฌูุจ ูุญููุธ", "ุฃุญูุฏ ุดููู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุฃููุงุฏ ุญุงุฑุชูุง'ุ",
        "options": ["ูุฌูุจ ูุญููุธ", "ููุณู ุฅุฏุฑูุณ", "ุฅุญุณุงู ุนุจุฏ ุงููุฏูุณ", "ุชูููู ุงูุญููู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฌุฑููุฉ ูุงูุนูุงุจ'ุ",
        "options": ["ูููุฏูุฑ ุฏูุณุชูููุณูู", "ุชููุณุชูู", "ูููููุงู ุบูุบูู", "ุฃูุทูู ุชุดูุฎูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ูุงุฑู ุจูุชุฑ'ุ",
        "options": ["ุฌู. ู. ุฑููููุบ", "ุชููููู", "ูุงุฑู ุชููู", "ูููุณ ูุงุฑูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ูุฆุฉ ุนุงู ูู ุงูุนุฒูุฉ'ุ",
        "options": ["ุบุงุจุฑููู ุบุงุฑุณูุง ูุงุฑููุฒ", "ุฎูุฑุฎู ูููุณ ุจูุฑุฎูุณ", "ุจุงุจูู ููุฑูุฏุง", "ูุงุฑูู ุจุงุฑุบุงุณ ููุณุง"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ูุจุฑูุงุก ูุชุญุงูู'ุ",
        "options": ["ุฌูู ุฃูุณุชู", "ุดุงุฑููุช ุจุฑููุชู", "ุฅููููู ุจุฑููุชู", "ูุงุฑู ุดููู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุนุฌูุฒ ูุงูุจุญุฑ'ุ",
        "options": ["ุฅุฑูุณุช ูููุบูุงู", "ููููุงู ููููุฑ", "ุฌูู ุดุชุงููุจู", "ุณููุช ููุชุฒุฌูุฑุงูุฏ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุนุงูู ุงูุฌุฏูุฏ ุงูุดุฌุงุน'ุ",
        "options": ["ุฃูุฏูุณ ููุณูู", "ุฌูุฑุฌ ุฃูุฑููู", "ุฑููููุฏ ุจุฑุงุฏุจุฑู", "ููุฑุช ููููุบูุช"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุฏูู ููุดูุช'ุ",
        "options": ["ููุบูู ุฏู ุซูุฑุจุงูุชุณ", "ุบูุณุชุงู ูููุจูุฑ", "ููุฑู ูููุฏููุบ", "ุฏุงููุงู ุฏููู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฅููุงุฐุฉ'ุ",
        "options": ["ููููุฑูุณ", "ูุฑุฌูู", "ุณููููููุณ", "ุฅุณุฎูููุณ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ููููุฉ ูุฏููุฉ'ุ",
        "options": ["ุงุจู ุงููููุน", "ุงุจู ุณููุง", "ุงููุงุฑุงุจู", "ุงูุฌุงุญุธ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ูุงููุช'ุ",
        "options": ["ููููุงู ุดูุณุจูุฑ", "ุฌูู ูููุชูู", "ุชููุงุณ ููุฑ", "ูุฑูุณุชููุฑ ูุงุฑูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุญุฑุงููุด'ุ",
        "options": ["ูุฌูุจ ูุญููุธ", "ุฅุญุณุงู ุนุจุฏ ุงููุฏูุณ", "ููุณู ุงูุณุจุงุนู", "ุนุจุฏ ุงูุฑุญูู ุงูุดุฑูุงูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุบุฑูุจ'ุ",
        "options": ["ุฃูุจูุฑ ูุงูู", "ุฌุงู ุจูู ุณุงุฑุชุฑ", "ุณูููู ุฏู ุจูููุงุฑ", "ูุฑุงูุฒ ูุงููุง"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ูุฒุฑุนุฉ ุงูุญููุงูุงุช'ุ",
        "options": ["ุฌูุฑุฌ ุฃูุฑููู", "ุฃูุฏูุณ ููุณูู", "ุฌููุณ ุฌููุณ", "ูุงููุง"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุจุคุณุงุก'ุ",
        "options": ["ูููุชูุฑ ููุฌู", "ุชุดุงุฑูุฒ ุฏูููุฒ", "ุฃูููุฑูู ุฏู ุจูุฒุงู", "ุฏููุง"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฃููุฑ'ุ",
        "options": ["ูููููู ูููุงูููู", "ุฌูู ููู", "ุชููุงุณ ููุจุฒ", "ุฌุงู ุฌุงู ุฑูุณู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฌุฑููุฉ ูุงูุนูุงุจ'ุ",
        "options": ["ูููุฏูุฑ ุฏูุณุชูููุณูู", "ุชููุณุชูู", "ูููููุงู ุบูุบูู", "ุฃูุทูู ุชุดูุฎูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุฃูู ุดูุณ ูุดุฑูุฉ'ุ",
        "options": ["ุฎุงูุฏ ุญุณููู", "ุฌุงุจุฑููู ุบุงุฑุณูุง ูุงุฑููุฒ", "ุฅูุฒุงุจูู ุงููููุฏู", "ุชุดูููุง ุฃุชุดูุจู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฒูุจูุฉ ุงูุณูุฏุงุก'ุ",
        "options": ["ุฃููุณูุฏุฑ ุฏููุง", "ุจูุฒุงู", "ูููุชูุฑ ููุฌู", "ุบูุณุชุงู ูููุจูุฑ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ูู ุงูุชุธุงุฑ ุบูุฏู'ุ",
        "options": ["ุตูููู ุจูููุช", "ุฌุงู ุจูู ุณุงุฑุชุฑ", "ุฃูุฌูู ูููุณูู", "ุขุฑุซุฑ ูููุฑ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุฅุญูุงุก ุนููู ุงูุฏูู'ุ",
        "options": ["ุฃุจู ุญุงูุฏ ุงูุบุฒุงูู", "ุงุจู ุฑุดุฏ", "ุงูุดุงูุนู", "ุฃุจู ุจูุฑ ุงูุฑุงุฒู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฃุฎูุฉ ูุงุฑุงูุงุฒูู'ุ",
        "options": ["ูููุฏูุฑ ุฏูุณุชูููุณูู", "ุชููุณุชูู", "ูููููุงู ุบูุบูู", "ุฃูุทูู ุชุดูุฎูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุนูู ูุนุงุทูุฉ'ุ",
        "options": ["ุฌูู ุฃูุณุชู", "ุฅููููู ุจุฑููุชู", "ุดุงุฑููุช ุจุฑููุชู", "ูุงุฑู ุดููู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฏูู ูุงูุฏู'ุ",
        "options": ["ุฑูุจุฑุชู ุณุงุจุงุชููู", "ุฏุงู ุจุฑุงูู", "ูุฑูุณุชููุฑ ุจุงููููู", "ุณุชููู ูููุบ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุณูุงุณุฉ ุงูุดุฑุนูุฉ'ุ",
        "options": ["ุงุจู ุชูููุฉ", "ุงุจู ุฎูุฏูู", "ุงูุบุฒุงูู", "ุงุจู ุงูููู ุงูุฌูุฒูุฉ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฑูุญุงููุฉ ูู ุงูุฅุณูุงู'ุ",
        "options": ["ุงูุบุฒุงูู", "ุงุจู ุงูููู", "ุงุจู ุณููุง", "ุงููุงุฑุงุจู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุฑุณุงูุฉ ุงูุบูุฑุงู'ุ",
        "options": ["ุฃุจู ุงูุนูุงุก ุงููุนุฑู", "ุงุจู ุงููููุน", "ุงูุฌุงุญุธ", "ุฃุจู ููุงุณ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงููุฑุฏูุณ ุงูููููุฏ'ุ",
        "options": ["ุฌูู ูููุชูู", "ุฏุงูุชู ุฃููุบููุฑู", "ููููุฑูุณ", "ููุฑุฌูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงููุงููู ูู ุงูุทุจ'ุ",
        "options": ["ุงุจู ุณููุง", "ุงุจู ุฑุดุฏ", "ุงุจู ุงููููุณ", "ุงูุฑุงุฒู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุทูู ุงูุญูุงูุฉ'ุ",
        "options": ["ุงุจู ุญุฒู", "ุงุจู ุงููููุน", "ุงูุฌุงุญุธ", "ุฃุจู ุชูุงู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฃููุฑ ุงูุตุบูุฑ'ุ",
        "options": ["ุฃูุทูุงู ุฏู ุณุงูุช ุฅูุฒูุจูุฑู", "ูููุชูุฑ ููุฌู", "ุจูุฒุงู", "ูุงุฑุณูู ุจุฑูุณุช"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ููุทู ุงูุทูุฑ'ุ",
        "options": ["ูุฑูุฏ ุงูุฏูู ุงูุนุทุงุฑ", "ุงุจู ุงููุงุฑุถ", "ุฌูุงู ุงูุฏูู ุงูุฑููู", "ุงุจู ุนุฑุจู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฏููุงููุฑูู'ุ",
        "options": ["ุฌูููุงูู ุจููุงุชุดู", "ุฏุงูุชู ุฃููุบููุฑู", "ูููุงูููู", "ุจุชุฑุงุฑู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุดุงุนุฑ ุงูุฌูุงู'ุ",
        "options": ["ุฅุฏุบุงุฑ ุขูุงู ุจู", "ุฑูุจูุฏุฑููุงุช ุทุงุบูุฑ", "ูููุงู ูุฑุฏุฒููุฑุซ", "ุตุงูููู ูููุฑูุฏุฌ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูููุฎ ุงูููุฏู'ุ",
        "options": ["ููุฑุฏ ุจูุฑูู", "ุชููุงุณ ููุฑ", "ุตูููู ุฌููุณูู", "ุฌูู ููุชุณ"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฃุจูู'ุ",
        "options": ["ูููุฏูุฑ ุฏูุณุชูููุณูู", "ุชููุณุชูู", "ูููููุงู ุบูุบูู", "ุฃูุทูู ุชุดูุฎูู"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ุงูุฎูููุงุฆู'ุ",
        "options": ["ุจุงููู ููููู", "ุฌุงุจุฑููู ุบุงุฑุณูุง ูุงุฑููุฒ", "ุฎูุฑุฎู ูููุณ ุจูุฑุฎูุณ", "ูุงุฑูู ุจุงุฑุบุงุณ ููุณุง"],
        "correct": 0
    },
    {
        "question": "ูู ูู ูุคูู ูุชุงุจ 'ูุฏู ุงูููุญ'ุ",
        "options": ["ุนุจุฏ ุงูุฑุญูู ูููู", "ูุฌูุจ ูุญููุธ", "ุฅุญุณุงู ุนุจุฏ ุงููุฏูุณ", "ููุณู ุงูุณุจุงุนู"],
        "correct": 0
    },
]


def get_main_menu_keyboard():
    keyboard = [
        ["ุนู ุงูุชุญุฏู", "ููููุฉ ุงููุดุงุฑูุฉ","ูููุน ุงูุชุญุฏู"],
        ["ุงูููุงุนุฏ", "ุงูููุงุนูุฏ ุงูููุงุฆูุฉ","ุชุญููู ุงูุฌูุงุฒุงุช"],
        ["ุงูุฌูุงุฆุฒ", "ุงูุชุฑุงุญ ูุชุงุจ","ุฏุฑุฏุดุฉ ุฐููุฉ"],
        ["ุงูุชูุฎูุต ุจุจุณุงุทุฉ","ุขููุฉ ุงูุชุญุฏู","ุชุตูููุงุช ุงููุชุจ"],["ุนู ุงูุชุตููุงุช", "ุฃุจุทุงู ุงูุชุญุฏู","ูุนุงููุฑ ุงุฎุชูุงุฑ ุงููุชุจ"],
        [ "ุฅุญุตุงุฆูุงุช ุงููุฑุงุกุฉ","ูุฌููุนุฉ ุงูููุณุจูู","ุงููุฑูุฒ ุงูุงุนูุงูู ูุงุฎุฑ ุงูุฃุฎุจุงุฑ"],
        ["ูุฌููุนุงุช ุงููุฑุงุกุฉ", "ุชุญุฏูุงุช ุงููุฑุงุกุฉ"], ["ุชุณุฌูู ุชูุฏู ุงููุฑุงุกุฉ", "ุงุฎุชุจุงุฑ ูุนูููุงุช"],
        ["ููุชุจุงุช ูููุตุงุช ูุชุจ"]
       
        
    ]
    return ReplyKeyboardMarkup(keyboard, resize_keyboard=True, one_time_keyboard=True)

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    user = update.effective_user
    c.execute("INSERT OR IGNORE INTO users (id, username) VALUES (?, ?)", (user.id, user.username))
    conn.commit()
    
    message = f"ูุฑุญุจูุง {user.first_name}! ุฃูุง ุจูุช ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู. ๐โจ\n" \
              "  ุฃูุง ููุง ููุณุงุนุฏุชู ูู ุฑุญูุชู ุงููุฑุงุฆูุฉ ููุดุงุฑูุฉ ุดุบูู ุจุงููุชุจ ูููุฑุฏ ุนูู ุฌููุน ุงุณุชูุณุงุฑุงุชู ุจุฎุตูุต ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู ."
    
    await update.effective_message.reply_text(message, reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def help_command(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    help_text = "ูุฑุญุจูุง ุจู ูู ุจูุช ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู! ุฅููู ุจุนุถ ุงูุฃูุงูุฑ ุงููููุฏุฉ:\n\n" \
                "/start - ูุจุฏุก ุงููุญุงุฏุซุฉ\n" \
                "/help - ูุนุฑุถ ูุฐู ุงูุฑุณุงูุฉ\n" \
                "/challenge - ูุจุฏุก ุชุญุฏู ูุฑุงุกุฉ ุฌุฏูุฏ\n" \
                "/stats - ูุนุฑุถ ุฅุญุตุงุฆูุงุช ุงููุฑุงุกุฉ ุงูุฎุงุตุฉ ุจู\n" \
                "/recommend - ููุญุตูู ุนูู ุชูุตูุฉ ูุชุงุจ"
    await update.message.reply_text(help_text, reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def handle_choice(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    choice = update.message.text
    
    choice_handlers = {
        "ุงูุชุฑุงุญ ูุชุงุจ": handle_book_recommendation,
        "ุชุณุฌูู ุชูุฏู ุงููุฑุงุกุฉ": handle_reading_progress,
        "ูุฑุงุฌุนุฉ ูุชุงุจ": handle_book_review,
        "ุงุฎุชุจุงุฑ ูุนูููุงุช": start_quiz,
        "ูุฌููุนุงุช ุงููุฑุงุกุฉ": handle_reading_groups,
        "ุชุญุฏูุงุช ุงููุฑุงุกุฉ": handle_reading_challenges,
        "ุชูุฎูุต ูุชุงุจ": handle_book_summarization,
    }
    
    handler = choice_handlers.get(choice)
    if handler:
        return await handler(update, context)
    else:
        response = await get_response_for_choice(choice, context)
        await update.message.reply_text(response, reply_markup=get_main_menu_keyboard())
    
    return CHOOSING

async def get_response_for_choice(choice: str, context: ContextTypes.DEFAULT_TYPE) -> str:
    responses = {
        "ููุชุจุงุช ูููุตุงุช ูุชุจ": (
            "ูููุน ุฌูุฏ ุฑูุฏุฒ: https://www.goodreads.com/\n"
            "ูููุน ุฌูุฏ ุฑูุฏุฒ ูู ุดุจูุฉ ุงุฌุชูุงุนูุฉ ูุฎุตุตุฉ ููุญุจู ุงููุฑุงุกุฉ ูุงููุชุจุ ุญูุซ ูููู ูููุณุชุฎุฏููู ุชูููู ุงููุชุจุ ุชุจุงุฏู ุงูุขุฑุงุกุ ูุฅูุดุงุก ููุงุฆู ูุฑุงุกุฉ ุดุฎุตูุฉ.\n"
            "ุงูููุชุจุฉ ุงูุดุงููุฉ: https://shamela.ws/ \n"
            "ููุชุจุฉ ูุงุณุนุฉ ุชุถู ุฃูุซุฑ ูู 8000 ูุชุงุจ ูู ุงููุชุจ ุงููุชุงุญุฉ ูู ุงููุฌุงู ุงูุนุงู.\n"
            "ููุชุจุฉ ุนูู ุงูุฌุงูุนุฉ: https://thebook.univeyes.com \n"
            "ูุฌููุนุฉ ุชุฒูุฏ ุนู 150000 ูุชุงุจ ูู ุชุฎุตุตุงุช ุฃูุงุฏูููุฉ ูุนูููุฉ ูุชุนุฏุฏุฉ.\n"
            "mENA DOC: https://menalib.de \n"
            "ูููุฑ ูุตููุงู ุบูุฑ ูุญุฏูุฏ ููุฃุฏุจ ุงููุชุนูู ุจููุทูุฉ ุงูุดุฑู ุงูุฃูุณุท ูุดูุงู ุฅูุฑูููุง ูุงูุฅุณูุงู.\n"
            "ุจูู ุงููุนุฑูู ุงููุตุฑู: https://ekb.eg \n"
            "ููุชุจุฉ ุฑูููุฉ ุชููุฑ ุงููุตูู ุฅูู ูุจุงุฑ ุงููุงุดุฑูู ุงูุฃูุงุฏููููู. ูุชููุฑุฉ ูู ูุตุฑ.\n"
            "ููุชุจุฉ ููุฑ: https://noor-book.com \n"
            "ุฃูุจุฑ ููุชุจุฉ ุฅููุชุฑูููุฉ ุนุฑุจูุฉ ุชุถู ุขูุงู ุงููุชุจ ุงููุงุจูุฉ ููุชูุฒูู.\n"
            "ูุคุณุณุฉ ููุฏุงูู: https://hindawi.org \n"
            "ููุธูุฉ ุบูุฑ ุฑุจุญูุฉ ูููุชูุง ุชุนุฒูุฒ ุงูุชุนููู ููุดุฑ ุญุจ ุงููุฑุงุกุฉ."
        ),
        "ุชุตูููุงุช ุงููุชุจ": (
            "1. ุงูุฃุฏุจ ูุงูุฑูุงูุงุช: ุชุดูู ุงูุฑูุงูุงุชุ ุงููุตุต ุงููุตูุฑุฉุ ุงูุดุนุฑุ ูุงููุณุฑุญูุงุช.\n"
    "   - ุงูุฑูุงูุงุช: ุชุชุถูู ุงูุฃุนูุงู ุงูุฎูุงููุฉ ุงูุชู ุชุฑูู ูุตุตุงู ุนุจุฑ ูุตูู ูุชุนุฏุฏุฉ."
    "   - ุงููุตุต ุงููุตูุฑุฉ: ูุตุต ูุฎุชุตุฑุฉ ุชุฑูุฒ ุนูู ูุดูุฏ ุฃู ุญุฏุซ ูุนูู.\n"
    "   - ุงูุดุนุฑ: ูุดูู ุงูุฃุนูุงู ุงูุดุนุฑูุฉ ุงูุชู ุชุณุชุฎุฏู ุงููุฒู ูุงููุงููุฉ.\n"
    "   - ุงููุณุฑุญูุงุช: ุงููุตูุต ุงูููุชูุจุฉ ููุนุฑุถ ุงููุณุฑุญู.\n\n"
    
    "2. ุงููุชุจ ุงูุชุนููููุฉ ูุงูุฃูุงุฏูููุฉ: ุชุดูู ูุชุจ ุงูููุงูุฌ ุงูุฏุฑุงุณูุฉุ ุงููุชุจ ุงูุฃูุงุฏูููุฉุ ูุงููุฑุงุฌุน ุงูุนูููุฉ.\n"
    "   - ูุชุจ ุงูููุงูุฌ ุงูุฏุฑุงุณูุฉ: ูุชุจ ุชุนุชูุฏูุง ุงููุฏุงุฑุณ ูุงูุฌุงูุนุงุช ุถูู ููุฑุฑุงุชูุง ุงูุชุนููููุฉ.\n"
    "   - ุงููุชุจ ุงูุฃูุงุฏูููุฉ: ููุงุฏ ุนูููุฉ ูุชุฎุตุตุฉ ุชุชูุงูู ููุถูุนุงุช ุจุญุซูุฉ ุนูููุฉ.\n"
    "   - ุงููุฑุงุฌุน ุงูุนูููุฉ: ูุชุจ ุชุณุชุฎุฏู ููุฑุฌุน ููุนูููุงุช ุฏูููุฉ ูู ูุฎุชูู ุงูุชุฎุตุตุงุช.\n\n"
    
    "3. ุงููุชุจ ุงูุชุงุฑูุฎูุฉ ูุงูุณูุงุณูุฉ: ุชุดูู ูุชุจ ุงูุชุงุฑูุฎุ ุงูุณูุฑ ุงูุฐุงุชูุฉุ ุงููุชุจ ุงูุณูุงุณูุฉุ ูุงููุฐูุฑุงุช.\n"
    "   - ูุชุจ ุงูุชุงุฑูุฎ: ุชุบุทู ุฃุญุฏุงุซูุง ูุดุฎุตูุงุช ุชุงุฑูุฎูุฉ ูู ูุฎุชูู ุงูุนุตูุฑ.\n"
    "   - ุงูุณูุฑ ุงูุฐุงุชูุฉ: ุชุฑูู ุญูุงุฉ ุดุฎุตูุงุช ูููุฉ ูุชุฃุซูุฑูุง ุนูู ุงููุฌุชูุน.\n"
    "   - ุงููุชุจ ุงูุณูุงุณูุฉ: ุชูุงูุด ุงูุฃูุฏููููุฌูุงุช ูุงูุฃูุธูุฉ ุงูุณูุงุณูุฉ ูุงูุฃุญุฏุงุซ ุงููุนุงุตุฑุฉ.\n"
    "   - ุงููุฐูุฑุงุช: ูุชุจ ุชุชุถูู ุชุฌุงุฑุจ ูุดูุงุฏุงุช ุดุฎุตูุฉ ูุฃูุฑุงุฏ ุนุงุดูุง ุฃุญุฏุงุซูุง ูููุฉ.\n\n"
    
    "4. ูุชุจ ุงูุชูููุฉ ุงูุจุดุฑูุฉ ูุชุทููุฑ ุงูุฐุงุช: ุชุดูู ูุชุจ ุงูุชุญููุฒุ ุงูููุงุฏุฉุ ุงูุชูููุฑ ุงูุฅูุฌุงุจูุ ูุฅุฏุงุฑุฉ ุงูููุช.\n"
    "   - ูุชุจ ุงูุชุญููุฒ: ุชูุฏู ุฅูู ุชุนุฒูุฒ ุงูุฏุงูุน ูุชุญููู ุงููุฌุงุญ ุงูุดุฎุตู.\n"
    "   - ูุชุจ ุงูููุงุฏุฉ: ุชุฑูุฒ ุนูู ุชุทููุฑ ุงูููุงุฑุงุช ุงูููุงุฏูุฉ ูุฅุฏุงุฑุฉ ุงููุฑู.\n"
    "   - ูุชุจ ุงูุชูููุฑ ุงูุฅูุฌุงุจู: ุชุชูุงูู ููููุฉ ุชุญุณูู ุงููุธุฑุฉ ููุญูุงุฉ ูุงูุชูููุฑ ุจุฅูุฌุงุจูุฉ.\n"
    "   - ูุชุจ ุฅุฏุงุฑุฉ ุงูููุช: ุชููุฑ ุงุณุชุฑุงุชูุฌูุงุช ูุชุญุณูู ููุงุกุฉ ุงุณุชุฎุฏุงู ุงูููุช.\n\n"
    
    "5. ุงููุชุจ ุงูุฏูููุฉ: ุชุดูู ูุชุจ ุงูุฃุฏูุงู ุงููุฎุชููุฉุ ุงูุชูุณูุฑุ ุงูุญุฏูุซุ ุงููููุ ูุงูุนููุฏุฉ.\n"
    "   - ูุชุจ ุงูุฃุฏูุงู: ุชุบุทู ุงููุตูุต ุงูููุฏุณุฉ ูุงูุชุนุงููู ุงูุฏูููุฉ ููุฃุฏูุงู ุงููุฎุชููุฉ.\n"
    "   - ูุชุจ ุงูุชูุณูุฑ: ุดุฑุญ ูุชูุณูุฑ ูููุฑุขู ุงููุฑูู.\n"
    "   - ูุชุจ ุงูุญุฏูุซ: ุชุฌูุน ุฃููุงู ูุฃูุนุงู ุงููุจู ูุญูุฏ ุตูู ุงููู ุนููู ูุณูู.\n"
    "   - ูุชุจ ุงูููู: ุชุชูุงูู ุงูุฃุญูุงู ุงูุดุฑุนูุฉ ูุชูุงุตูู ุงูุนุจุงุฏุฉ.\n"
    "   - ูุชุจ ุงูุนููุฏุฉ: ุชุชุนูู ุจูุจุงุฏุฆ ุงูุฅููุงู ูุงูุฃุณุณ ุงูุนูุงุฆุฏูุฉ ูู ุงูุฏูู.\n\n"
    
    "6. ุงููุชุจ ุงููููุฉ ูุงูุซูุงููุฉ: ุชุดูู ูุชุจ ุงูููุ ุงูููุณูููุ ุงูุณูููุงุ ุงููุณุฑุญุ ูุงูุซูุงูุฉ ุงูุนุงูุฉ.\n"
    "   - ูุชุจ ุงููู: ุชุชูุงูู ุชุงุฑูุฎ ุงููู ูุฃููุงุนู ูุฃุนูุงู ุงูููุงููู ุงููุดููุฑูู.\n"
    "   - ูุชุจ ุงูููุณููู: ุชุดุฑุญ ุชุงุฑูุฎ ุงูููุณููู ูุงููุธุฑูุงุช ุงูููุณูููุฉ.\n"
    "   - ูุชุจ ุงูุณูููุง: ุชุฏุฑุณ ุตูุงุนุฉ ุงูุฃููุงูุ ุชุงุฑูุฎ ุงูุณูููุงุ ูููุฏ ุงูุฃููุงู.\n"
    "   - ูุชุจ ุงููุณุฑุญ: ุชุบุทู ุชุงุฑูุฎ ุงููุณุฑุญ ูุฃุนูุงูู ูุชูุงููุฏู.\n"
    "   - ุงูุซูุงูุฉ ุงูุนุงูุฉ: ูุชุจ ุชูุฏู ูุนูููุงุช ุนุงูุฉ ุญูู ููุถูุนุงุช ูุชููุนุฉ ุชุฎุต ุงููุฌุชูุน.\n\n"
    
    "7. ุงููุชุจ ุงูุนูููุฉ ูุงูุชูููุฉ: ุชุดูู ูุชุจ ุงูุนูููุ ุงูุชูููููุฌูุงุ ุงูููุฏุณุฉุ ุงูุทุจุ ูุงูุนููู ุงูุตุญูุฉ.\n"
    "   - ูุชุจ ุงูุนููู: ุชุชูุงูู ุงูููุฒูุงุกุ ุงูููููุงุกุ ุงูุฃุญูุงุกุ ูุบูุฑูุง ูู ุงูุนููู ุงูุทุจูุนูุฉ.\n"
    "   - ูุชุจ ุงูุชูููููุฌูุง: ุชุชุนูู ุจุงูุชูููุงุช ุงูุญุฏูุซุฉ ูุงูุญูุณุจุฉ.\n"
    "   - ูุชุจ ุงูููุฏุณุฉ: ุชุบุทู ูุฎุชูู ูุฑูุน ุงูููุฏุณุฉ ูุซู ุงููุฏููุฉุ ุงูููุฑุจุงุฆูุฉุ ูุงููููุงููููุฉ.\n"
    "   - ูุชุจ ุงูุทุจ: ุชุดูู ููุถูุนุงุช ุทุจูุฉุ ุนูุงุฌูุฉุ ูุตุญูุฉ.\n"
    "   - ูุชุจ ุงูุนููู ุงูุตุญูุฉ: ุชุชุนูู ุจุงูุตุญุฉ ุงูุนุงูุฉุ ุงูุชุบุฐูุฉุ ูุงูุทุจ ุงูุจุฏูู.\n\n"
    
    "8. ุงููุชุจ ุงูุชุฑููููุฉ ูุงูููุงูุงุช: ุชุดูู ูุชุจ ุงูุทุจุฎุ ุงูุฑูุงุถุฉุ ุงูุณูุฑุ ุงูุฃูุนุงุจุ ูุงูุฃูุบุงุฒ.\n"
    "   - ูุชุจ ุงูุทุจุฎ: ุชุญุชูู ุนูู ูุตูุงุช ููุตุงุฆุญ ููุทูู.\n"
    "   - ูุชุจ ุงูุฑูุงุถุฉ: ุชุชุนูู ุจุงูุฑูุงุถุงุช ุงููุฎุชููุฉุ ุงูุชุฏุฑูุจุ ูุงูููุงูุฉ ุงูุจุฏููุฉ.\n"
    "   - ูุชุจ ุงูุณูุฑ: ุชูุฏู ูุนูููุงุช ููุตุงุฆุญ ุญูู ุงูุณูุฑ ูุงููุบุงูุฑุงุช.\n"
    "   - ุงูุฃูุนุงุจ ูุงูุฃูุบุงุฒ: ูุชุจ ุชุญุชูู ุนูู ุฃูุนุงุจ ููุฑูุฉ ูุฃูุบุงุฒ ููุชุณููุฉ ูุงูุชุญุฏู.\n\n"
    
    "9. ูุชุจ ุงูุฃุทูุงู ูุงููุงูุนูู: ุชุดูู ุงููุตุต ุงููุตูุฑุฉุ ุงูุญูุงูุงุชุ ูุชุจ ุงูุชุนููู ุงููุจุณุทุ ููุชุจ ุงููุงูุนูู.\n"
    "   - ุงููุตุต ุงููุตูุฑุฉ: ูุชุจ ุชุญุชูู ุนูู ูุตุต ููุฃุทูุงู ูุน ุฑุณูู ุชูุถูุญูุฉ.\n"
    "   - ุงูุญูุงูุงุช: ูุตุต ุชูููุฏูุฉ ุฃู ุดุนุจูุฉ ููุฌูุฉ ููุฃุทูุงู.\n"
    "   - ูุชุจ ุงูุชุนููู ุงููุจุณุท: ูุชุจ ุชูุฏู ูุชุนููู ุงูุฃุทูุงู ูุจุงุฏุฆ ุฃุณุงุณูุฉ ูุซู ุงูุฃุฑูุงู ูุงูุญุฑูู.\n"
    "   - ูุชุจ ุงููุงูุนูู: ุฑูุงูุงุช ููุชุจ ุชูุงุณุจ ุงููุฆุฉ ุงูุนูุฑูุฉ ุงูุตุบูุฑุฉ ูุงูุดุจุงุจูุฉ.\n\n"
    
    "10. ุงููุชุจ ุงูุงูุชุตุงุฏูุฉ ูุงูุฅุฏุงุฑูุฉ: ุชุดูู ูุชุจ ุงูุงูุชุตุงุฏุ ุงูุฅุฏุงุฑุฉุ ุงูุฃุนูุงูุ ุงูุงุณุชุซูุงุฑุ ูุงูุชุณููู.\n"
    "   - ูุชุจ ุงูุงูุชุตุงุฏ: ุชุชูุงูู ุงููุธุฑูุงุช ุงูุงูุชุตุงุฏูุฉ ูุงูุงูุชุตุงุฏ ุงูุนุงููู.\n"
    "   - ูุชุจ ุงูุฅุฏุงุฑุฉ: ุชุชุนูู ุจุฅุฏุงุฑุฉ ุงูุฃุนูุงูุ ุงููุคุณุณุงุชุ ูุชูุธูู ุงูุนูู.\n"
    "   - ูุชุจ ุงูุฃุนูุงู: ุชุชูุงูู ุชุฃุณูุณ ูุฅุฏุงุฑุฉ ุงูุดุฑูุงุช ุงูุตุบูุฑุฉ ูุงููุชูุณุทุฉ.\n"
    "   - ูุชุจ ุงูุงุณุชุซูุงุฑ: ุชูุฏู ูุตุงุฆุญ ูุงุณุชุฑุงุชูุฌูุงุช ููุงุณุชุซูุงุฑ ูู ุงูุฃุณูุงู ุงููุงููุฉ.\n"
    "   - ูุชุจ ุงูุชุณููู: ุชุบุทู ุงุณุชุฑุงุชูุฌูุงุช ุงูุชุณููู ูุงูุฅุนูุงูุงุช ูุจุญูุซ ุงูุณูู.\n"
        ),
    "ูุนุงููุฑ ุงุฎุชูุงุฑ ุงููุชุจ": (" ูุนุงููุฑ ุงุฎุชูุงุฑ ุงููุชุจ ุงููุคููุฉ ูููุดุงุฑูุฉ ูู ุงููุณุฎุฉ ุงููุงุฏูุฉ ูู ุงููุณุงุจูุฉ. ููููุง ููุดุฑูุท ุงููุญุฏุฏุฉุ ูุฌุจ ุฃู ุชุชูุงูู ุงููุชุจ ุงูููุฑูุกุฉ ูุน ุงููุนุงููุฑ ุงูุชุงููุฉ:\n"
    "- ุงููุบุฉ: ูุฌุจ ุฃู ุชููู ุงููุชุจ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ุงููุตุญู.\n"
    "- ูุณุชูู ุงููุฑุญูุฉ ุงูุชุนููููุฉ: ููุจุบู ุฃู ุชููู ุงููุชุจ ููุงุฆูุฉ ููุฑุญูุฉ ุงูุทุงูุจ ุงูุชุนููููุฉ ูู ุญูุซ ุงูููุถูุน ูุนุฏุฏ ุงูุตูุญุงุช.\n"
    "- ุงููุญุชูู: ููุดุชุฑุท ุฃู ูุง ุชููู ุงููุชุจ ุนุจุงุฑุฉ ุนู ูุฑุงุฌุนุ ูุฌูุงุชุ ุตุญูุ ุฃู ุฌุฒุก ูู ุงููููุงุฌ ุงูุฏุฑุงุณู ููุทุงูุจ.\n"
    "- ุนุฏุฏ ุงูุตูุญุงุช: ูุฎุชูู ุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงูุตูุญุงุช ุงููุทููุจุฉ ุจุญุณุจ ุงููุฑุญูุฉ ุงูุชุนููููุฉ:\n"
    " - ุงููุฑุญูุฉ ุงูุฃููู (ุงูุตู ุงูุฃูู ุฅูู ุงูุซุงูุซ ุงูุงุจุชุฏุงุฆู): 5 ุตูุญุงุช ูุญุฏ ุฃุฏูู.\n"
    " - ุงููุฑุญูุฉ ุงูุซุงููุฉ (ุงูุตู ุงูุฑุงุจุน ุฅูู ุงูุณุงุฏุณ ุงูุงุจุชุฏุงุฆู): 21 ุตูุญุฉ ูุญุฏ ุฃุฏูู.\n"
    " - ุงููุฑุญูุฉ ุงูุซุงูุซุฉ (ุงูุตู ุงูุฃูู ุฅูู ุงูุซุงูุซ ุงูุฅุนุฏุงุฏู): 31 ุตูุญุฉ ูุญุฏ ุฃุฏูู.\n"
    " - ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ (ุงูุตู ุงูุฃูู ุฅูู ุงูุซุงูุซ ุงูุซุงููู): 51 ุตูุญุฉ ูุญุฏ ุฃุฏูู.\n"
    "ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ ุชุคูุฏ ุงููุฌูุฉ ุงูููุธูุฉ ูููุณุงุจูุฉ ุฃู ุงูุชุณุฌูู ูุฌุจ ุฃู ูุชู ูู ุฎูุงู ุงููุฏุงุฑุณุ ุญูุซ ูุง ููุณูุญ ุจุงููุดุงุฑูุฉ ุงููุฑุฏูุฉ. ููุนุฏ ูุฐุง ุงูุดุฑุท ุฌุฒุกูุง ูู ุงูุฅุฌุฑุงุกุงุช ุงูุชูุธูููุฉ ูุถูุงู ุฌูุฏุฉ ุงูุชูููู ูุงููุชุงุจุนุฉ ุงููุนุงูุฉ ููุทูุงุจ ุงููุดุงุฑููู."
    ),
        "ุงููุฑูุฒ ุงูุงุนูุงูู ูุงุฎุฑ ุงูุฃุฎุจุงุฑ": ("ุงุฏุฎู ุนูู ุงูุฑุงุจุท ููุนุฑูุฉ ุงุฎุฑ ุงูุงุฎุจุงุฑ:\n"
                                         "https://arabreadingchallenge.com/ar#m_news"),
        "ุขููุฉ ุงูุชุญุฏู": ("ูุชู ุชุณุฌูู ุงูุทูุงุจ ูู ุฎูุงู ูุฏุงุฑุณูู ููุดุฑูููู.\n"
                        "ุจุนุฏ ุงูุชุณุฌููุ ูุณุชูู ูู ุทุงูุจ ูุณุฌู ุฌูุงุฒ ุงููุฑุญูุฉ ุงูุฃููู ุฐู ุงูููู ุงูุฃุญูุฑ ูุงูุฐู ูุญุชูู ุนูู 10 ุชุฃุดูุฑุงุช ูุฑุงุกุฉ ุจูุงูุน 10 ุตูุญุงุช. ููุฑุฃ ุงูุทุงูุจ ุงููุชุงุจ ูููุฎุตู ูู ุตูุญุฉ ูุงุญุฏุฉ ููุญุตู ุจุฐูู ุนูู ุชุฃุดูุฑุฉ ุงููุฑุงุกุฉ.\n"
                        "ูููู ุงูุทุงูุจ ุนุดุฑุฉ ูุชุจ ูููุฎุตูุง ูู ุนุดุฑ ุตูุญุงุช ุญุชู ูููู ุงููุฑุญูุฉ ุงูุฃููู ูููุชูู ูููุฑุญูุฉ ุงูุซุงููุฉ ูุงูุฌูุงุฒ ุงูุฃุฎุถุฑ.\n"
                        "ูููู ุงูุทุงูุจ ุนุดุฑุฉ ูุชุจ ุฌุฏูุฏุฉ ูููุฎุตูุง ูู ุนุดุฑ ุตูุญุงุช ุญุชู ูููู ุงููุฑุญูุฉ ุงูุซุงููุฉ ูููุชูู ูููุฑุญูุฉ ุงูุซุงูุซุฉ ูุงูุฌูุงุฒ ุงูุฃุฒุฑู.\n"
                        "ูููู ุงูุทุงูุจ ุนุดุฑุฉ ูุชุจ ุฌุฏูุฏุฉ ูููุฎุตูุง ูู ุนุดุฑ ุตูุญุงุช ุญุชู ูููู ุงููุฑุญูุฉ ุงูุซุงูุซุฉ ูููุชูู ูููุฑุญูุฉ ุงูุฑุงุจุนุฉ ูุงูุฌูุงุฒ ุงููุถู.\n"
                        "ูููู ุงูุทุงูุจ ุนุดุฑุฉ ูุชุจ ุฌุฏูุฏุฉ ูููุฎุตูุง ูู ุนุดุฑ ุตูุญุงุช ุญุชู ูููู ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ ูููุชูู ูููุฑุญูุฉ ุงูุฎุงูุณุฉ ูุงูุฌูุงุฒ ุงูุฐูุจู.\n"
                        "ูููู ุงูุทุงูุจ ุนุดุฑุฉ ูุชุจ ุฌุฏูุฏุฉ ูููุฎุตูุง ูู ุนุดุฑ ุตูุญุงุช ุญุชู ูููู ุงููุฑุญูุฉ ุงูุฎุงูุณุฉ ูุงูุฃุฎูุฑุฉ ูู ุงููุฑุงุกุฉุ ููููู ุจุฐูู ูุฏ ูุงู ุจูุฑุงุกุฉ ูุชูุฎูุต ุฎูุณูู ูุชุงุจุงู ุฎุงุฑุฌ ุงูููุฑุฑ ุฎูุงู ุงูุนุงู ุงูุฏุฑุงุณู."
                        ),
          "ุชุญููู ุงูุฌูุงุฒุงุช": ("ุงุฏุฎู ุนูู ูุฐุง ุงูุฑุจุท\n"
                             "https://arabreadingchallenge.com/ar/tool-box"),
        "ูููุน ุงูุชุญุฏู": ("ุงุฏุฎู ุนูู ูุฐุง ุงูุฑุจุท\n"
                             "https://arabreadingchallenge.com/ar" 
                             ),
         "ุฃุจุทุงู ุงูุชุญุฏู": ( "ุฃุจุทุงู ุงูุชุญุฏู ุงูุณุงุจููู:\n"
            "ุงูููุณู ุงูุณุงุจุน 2022-2023: ุขููุฉ ุงูููุตูุฑู (ุงูุฅูุงุฑุงุช) ูุนุจุฏ ุงููู ุงูุจุฑู (ูุทุฑ).\n"
            "ุงูููุณู ุงูุณุงุฏุณ 2021-2022: ุดุงู ุงูุจููุฑ (ุณูุฑูุง).\n"
            "ุงูููุณู ุงูุฎุงูุณ 2019-2020: ุนุจุฏ ุงููู ูุญูุฏ ูุฑุงุฏ ุงุจู ุฎูู (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุฑุงุจุน 2018-2019: ูุฏูู ุฃููุฑ ุงูุฒุจูุฑ ุนุจุฏ ุงูุฑุญูู (ุงูุณูุฏุงู).\n"
            "ุงูููุณู ุงูุซุงูุซ 2017-2018: ูุฑูู ูุญุณู ุงูุฌูู (ุงููุบุฑุจ).\n"
            "ุงูููุณู ุงูุซุงูู 2016-2017: ุนูุงู ุฑุงุฆุฏ ุดุฑูู (ููุณุทูู).\n"
            "ุงูููุณู ุงูุฃูู 2015-2016: ูุญูุฏ ุนุจุฏ ุงููู ูุฑุญ ุฌููุฏ (ุงูุฌุฒุงุฆุฑ).\n"
        "ูุดุฑููู ูุชููุฒูู:\n"
            "ุงูููุณู ุงูุณุงุจุน 2022-2023: ุณูุงูุฑ ุงูุณูุงุนู (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุณุงุฏุณ 2021-2022: ููุฑ ุงูุฌุจูุฑ (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุฎุงูุณ 2019-2020: ููุฒุฉ ุงูุบูุงุฉ (ุงูุฅูุงุฑุงุช).\n"
            "ุงูููุณู ุงูุฑุงุจุน 2018-2019: ุฃููุฑุฉ ูุญูุฏ ูุฌูุจ (ูุตุฑ).\n"
            "ุงูููุณู ุงูุซุงูุซ 2017-2018: ุนุงุฆุดุฉ ุงูุทููุฑูู (ุงูุณุนูุฏูุฉ).\n"
            "ุงูููุณู ุงูุซุงูู 2016-2017: ุญูุฑูุฉ ุงูุธู (ุงููุบุฑุจ).\n"
        "ูุฏุงุฑุณ ูุงุฆุฒุฉ.\n"
            "ุงูููุณู ุงูุณุงุจุน 2022-2023: ูุฏุฑุณุฉ ุงูููู ุนุจุฏ ุงููู ุงูุซุงูู ููุชููุฒ (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุณุงุฏุณ 2021-2022: ูุฏุฑุณุฉ ุงูุฑุคูุฉ ุงูุนุงูููุฉ (ุงูุฅูุงุฑุงุช).\n"
            "ุงูููุณู ุงูุฎุงูุณ 2019-2020: ูุฏุฑุณุฉ ุงูุดูุฎ ุฒุงูุฏ ุจู ุณูุทุงู (ุงูุณุนูุฏูุฉ).\n"
            "ุงูููุณู ุงูุฑุงุจุน 2018-2019: ูุฏุฑุณุฉ ุงูุจูุงุช ุงูุซุงูููุฉ (ุงูุณูุฏุงู).\n"
            "ุงูููุณู ุงูุซุงูุซ 2017-2018: ูุฏุฑุณุฉ ุงููุตุฑ (ุงููุบุฑุจ)."
        ),
        "ุงูุชูุฎูุต ุจุจุณุงุทุฉ": (
        "ุฅู ุนูููุฉ ุงูุชูุฎูุต ุชุญุชุงุฌ ุฅูู ุงุชุจุงุน ุจุนุถ ุงูุฎุทูุงุชุ ุฃู ุงููุฑุงุญูุ ููุฐู ุงููุฑุงุญู ุชุชูุซู ูู ุซูุงุซุ ููู (ูุฑุญูุฉ ุงูุชูููุฏุ ูุฑุญูุฉ ุงูุชูุฎูุต ุงููุนููุ ูุฑุญูุฉ ุงูุชูููู).\n"
        "ุงููุฑุญูุฉ ุงูุฃููู (ุงูุชูููุฏ):\n"
        "ุชุชู ูุฐู ุงููุฑุญูุฉ ุจูุฑุงุกุฉ ุงูููุฑุฉ ุจุฏูุฉุ ุญุชู ูุชู ุงููููู ุนูู ุงูููุฑุฉ ุงูุฑุฆูุณูุฉุ ููุฏู ุงููุงุชุจ ูู ูุชุงุจุชูุง ูุฅุจุฑุงุฒูุง.\n"
        "ุซู ูุชู ุงููููู ุนูู ุงูููุฑุฏุงุช ุงูุฃุณุงุณูุฉ ุงูุชู ุชุฑุชูุฒ ุงูุฃููุงุฑ ุนูููุงุ ุญุชู ูุง ูุชู ุฅุบูุงููุง ุฃุซูุงุก ุงูุชูุฎูุต. ูุจุนุฏ ุฐูู ูุชู ูุนุฑูุฉ ุจููุฉ ุงููุต ูุชุญุฏูุฏ ุฃููุงุฑู ุงูุฑุฆูุณูุฉ ูุฃููุงุฑู ุงููุฑุนูุฉ ูุงูุชุณูุณู ุงูุฐู ูุงู ุงููุงุชุจ ุจุงุชุจุงุนู ูู ุนุฑุถ ุงูููุถูุน."
        "ุงููุฑุญูุฉ ุงูุซุงููุฉ (ุงูุชูุฎูุต ุงููุนูู):\n"
        "ููู ูุฐู ุงููุฑุญูุฉ ูุชู ุญุฐู ุงูุฌูู ุงูุชู ููุณ ููุง ุฏุงุนูุ ูุซู ุงูููุฑุฏุงุช ูุงูุฃููุงุฑ ุงูููุฑุฑุฉ ูุงูุฌูู ุงูุงุนุชุฑุงุถูุฉ ูุงูุชูุณูุฑูุฉ ููุง ุฅูู ุฐูู.\n"
        "ุซู ูุจุฏุฃ ูู ุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูููุฑุฉ ุจุงูุฃุณููุจ ุงููุณุชูู ุงูุดุฎุตูุ ูุงูุญุฑุต ุนูู ุฃู ูุชู ุฅุนุงุฏุฉ ุงููุชุงุจุฉ ุจุญูุงุฏ ูููุถูุนูุฉ ูุน ุงููุญุงูุธุฉ ุนูู ุงูุชูุงุฒู ูุงูุชุณูุณู ุจุญูุซ ูุชูุงุณุจ ูุน ุชุณูุณู ุงููุต ุงูุฃุตูู ูุชูุงุฒู ุฃูุณุงูู.\n"
        "ูููู ุงุณุชุนุงุฑุฉ ูููุงุช ุงููุชุงุจ ุงูุฃุตููุฉ ุงูุฏูููุฉ ูุงููุงูุฉุ ุญุชู ูุง ุชุญู ุงููุฑุงุฏูุงุช ุจุงููุนูู ุงููุฑุงุฏ ุซู ูุชุงุจุฉ ุงูุชูุฎูุต ุจูุบุฉ ุณูููุฉ ูุตูุญุฉ ููุชุฏุงููุฉุ ูุงูุชุฃูุฏ ูู ุฃู ุงููุต ุงูุฌุฏูุฏ ูุชูุงุณูุงู ููุชุฑุงุจุทุงู ูุน ุงููุต ุงูุฃุตูู.\n"
        "ุงููุฑุญูุฉ ุงูุซุงูุซุฉ (ุงูุชูููู):\n"
        "ุจุนุฏ ุงูุงูุชูุงุก ูุชู ุฅุนุงุฏุฉ ูุฑุงุกุฉ ุงููุต ุงูุฌุฏูุฏ ูุญุฐู ุงููููุงุช ุงูุฒุงุฆุฏุฉุ ูุงูููุงู ุจููุงุฑูุฉ ุงููุต ุงูุฌุฏูุฏ ุจุงููุต ุงูุฃุตูู ูุงูุชุฃูุฏ ุฃู ูููู ููุงู ุงุฎุชูุงูุงุช ูู ุงูุตูุงุบุฉ ููุฌูุฏ ุชุทุงุจู ูู ุงูุฌููุฑ. ููุง ุฃูู ูุงุจุฏ ูู ุงูุชุฃููุฏ ูู ูุฌูุฏ ุงูุชุณูุณู ูุงูุชูุงุณู ูุง ุจูู ุงูุฃููุงุฑ ูุงูุฌูู ูุงูููุฑุงุชุ ูุนุฏ ุงูุฃุณุทุฑ ูุงููููุงุช ููุชุฃูุฏ ูู ุงูุงูุชุฒุงู ุจุงูุญุฌู ุงููุงุฒู.\n"
        "ูููููู ุงูุชุนุฑู ุนูู ุงูููุถูุน ุจุทุฑููุฉ ุฃุณูู ูู ุฎูุงู ูุฐุง ุงูุฑุงุจุท: https://www.facebook.com/ema.N.1157/videos/2738110179680783/?idorvanity=1102168584000760"
        ),

        "ุนู ุงูุชุตููุงุช": (
            "ุงูุชุตููุฉ ุงูุฃููู: ุชุชู ุงูุชุตููุฉ ุงูุฃููู ุนูู ูุณุชูู ุงููุฏุฑุณุฉ ุฃู ุงูุฅุฏุงุฑุฉ ุงูุชุนููููุฉุ ุญูุซ ูุชูุงูุณ "
            "ุงูุทูุงุจ ุฏุงุฎู ุงููุฏุฑุณุฉ ุงููุงุญุฏุฉ. ูุชู ุชุตุนูุฏ 5 ุทูุงุจ ูู ูู ูุฑุญูุฉ ููุชุตููุงุช ุงูุซุงููุฉ.\n\n"
            "ุงูุชุตููุฉ ุงูุซุงููุฉ: ุชุชู ุงูุชุตููุฉ ุงูุซุงููุฉ ุนูู ูุณุชูู ุงููุญุงูุธุฉ ุฃู ุงูููุทูุฉ ุงูุชุนููููุฉุ ุญูุซ ูุชูุงูุณ "
            "ุงูุทูุงุจ ุฏุงุฎู ุงูููุทูุฉ ุงูุชุนููููุฉ. ูููุฒ 11 ุทุงูุจูุง ูู ูู ูุฑุญูุฉุ ููุชู ุฅุฌุฑุงุก ุชุตููุฉ ุจูู ุงูุฃูุงุฆู "
            "ุนูู ุงููุฑุงุญู ูุงุฎุชูุงุฑ ุจุทู ุงูููุณู ูุงุญุฏ ูู ุงูุฃุตุญุงุก ูุขุฎุฑ ูู ุฐูู ุงูููู.\n\n"
            "ุงูุชุตููุฉ ุงูุซุงูุซุฉ: ุงูุชุตููุฉ ุงูุซุงูุซุฉ ุชุชู ุนูู ูุณุชูู ุงูุฏููุฉุ ุญูุซ ูุชู ุงุฎุชูุงุฑ ุจุทู ุงูุฏููุฉ ูู ุงูุฃุตุญุงุก "
            "ูุขุฎุฑ ูู ุฐูู ุงููููุ ููุฐูู ุชุฑุชูุจ ุงููุฑุงูุฒ ูู ุงูุซุงูู ุฅูู ุงูุนุงุดุฑุ ุจุงูุฅุถุงูุฉ ุฅูู ุงููุฑูุฒูู ุงูุซุงูู "
            "ูุงูุซุงูุซ ูู ุฐูู ุงูููู.\n\n"
            "ุงูุชุตููุฉ ุงูุฑุงุจุนุฉ: ุงูุชุตููุฉ ุงูุฑุงุจุนุฉ ุชุชู ุนูู ูุณุชูู ุงููุทู ุงูุนุฑุจูุ ุญูุซ ูุชู ุงุฎุชูุงุฑ ุงููุฑุงูุฒ ูู ุงูุซุงูู "
            "ุฅูู ุงูุนุงุดุฑุ ูุงูุฅุนูุงู ุนู ุจุทู ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู ุนูู ูุณุชูู ุงููุทู ุงูุนุฑุจูุ ุจุงูุฅุถุงูุฉ ุฅูู ุจุทู "
            "ูู ุฐูู ุงูููู."
            "ูุนูููุงุช ุนู ุงูุชุตููุงุช:https://www.facebook.com/watch/?v=576595661080059"
        ),
        "ุนู ุงูุชุญุฏู": (
            "ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู ูู ุฃูุจุฑ ูุดุฑูุน ุนุฑุจู ุฃุทููู ุตุงุญุจ ุงูุณูู ุงูุดูุฎ ูุญูุฏ ุจู ุฑุงุดุฏ ุขู ููุชูู "
            "ูู ุนุงู 2015ุ ุจูุฏู ุชุดุฌูุน ุงููุฑุงุกุฉ ูุฏู ุงูุทูุงุจ ูู ุงูุนุงูู ุงูุนุฑุจู. ูุณุนู ุงูุชุญุฏู ุฅูู ุฅููุงู "
            "ุฃูุซุฑ ูู ููููู ุทุงูุจ ููุฑุงุกุฉ ุฎูุณูู ููููู ูุชุงุจ ุฎูุงู ูู ุนุงู ุฏุฑุงุณู. ููุฏู ุงููุดุฑูุน ุฅูู ุชุนุฒูุฒ "
            "ุงูุซูุงูุฉ ุงูุนุงูุฉ ูุชุทููุฑ ููุงุฑุงุช ุงููุบุฉ ุงูุนุฑุจูุฉ ูุฏู ุงูุดุจุงุจ."
        ),
        "ููููุฉ ุงููุดุงุฑูุฉ": (
        "โข ุชูุงุตู ูุน ูุดุฑู ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู ูู ุงููุฏุฑุณุฉ ูุชุณุฌููู ูู ุงูุชุญุฏู ูุงุณุชูุงู ุงูุฌูุงุฒุงุช.\n"
        "โข ุฃููู ุทูุจ ุงูุชุณุฌูู ูุชุนุฑู ุนูู ุงูููุงุนุฏ ูุงูููุงุฆุญ ุงูุฎุงุตุฉ ุจูุจุงุฏุฑุฉ ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู.\n"
        "โข ุงุณุชูู ุฌูุงุฒ ุงูุณูุฑ ุงูุฎุงุต ุจูุ ูุฃุฏุฑุฌ ุงูุชูุงุตูู ุงูุดุฎุตูุฉ ุงูุฎุงุตุฉ ุจู.\n"
        "โข ุงุณุฃู ุงููุดุฑู ููุญุตูู ุนูู ูุงุฆูุฉ ูู ุงููุชุจ ุงูููุตู ุจูุง.\n"
        "โข ุงูุฑุฃ ุงููุชุจ ููู ุจุชูุฎูุตูุง ูู ุฌูุงุฒ ุงูุชุญุฏู ุงูุฎุงุต ุจู.\n"
        "โข ุงูุชูู ุฅูู ุงูุฌูุงุฒ ุงูุชุงูู ูู ุงูุชุณูุณู ุจุนุฏ ุฅููุงุก ูุฑุงุกุฉ 10 ูุชุจ.\n"
        "โข ุงูุฑุฃ 40 ูุชุงุจุงู ุขุฎุฑุ ููู ุจุชูุฎูุตูุง ูู ุฌูุงุฒุงุช ุงูุชุญุฏู ุงูุฅุถุงููุฉ."
    ),
        "ุงูููุงุนุฏ": (
            "ูููุดุงุฑูุฉ ูู ุงูุชุญุฏูุ ูุฌุจ ุงุชุจุงุน ุงูููุงุนุฏ ุงูุชุงููุฉ:\n"
            "1. ุงูุฑุฃ ุจุงูุชุธุงู ุงููุชุจ ุจุงููุบุฉ ุงูุนุฑุจูุฉ.\n"
            "2. ุณุฌู ุชูุฎูุตุงุชู ูููุชุจ ูู ุฌูุงุฒ ุงูุชุญุฏู.\n"
            "3. ูุฌุจ ุฃู ุชููู ุงููุชุจ ุงูุชู ุชูุฑุฃูุง ููุงุณุจุฉ ููุณุชูุงู ุงูุฏุฑุงุณู.\n"
            "4. ุญุงูุธ ุนูู ุฌูุฏุฉ ุงูุชูุฎูุตุงุช ูุชุฃูุฏ ูู ุชูุฏูููุง ูู ุงูููุงุนูุฏ ุงููุญุฏุฏุฉ.\n"
            "5. ุดุงุฑู ูู ุงูุชุญุฏูุงุช ุงูุดูุฑูุฉ ูุงููุตููุฉ ูุชุนุฒูุฒ ูุฑุตู ูู ุงูููุฒ."
        ),
        "ุงูููุงุนูุฏ ุงูููุงุฆูุฉ": (
            "ุงูุชุญุฏู ูุณุชูุฑ ุทูุงู ุงูุนุงู ุงูุฏุฑุงุณูุ ูุน ูุฌูุฏ ููุงุนูุฏ ููุงุฆูุฉ ููู ูุฑุญูุฉ ูู ูุฑุงุญู ุงูุชุญุฏู. "
            "ุชุฎุชูู ุงูููุงุนูุฏ ูู ุจูุฏ ูุขุฎุฑุ ูุฐุง ููุถู ูุชุงุจุนุฉ ุงูุชุญุฏูุซุงุช ูู ุฎูุงู ุงููุฏุฑุณุฉ ุฃู ุงููููุน ุงูุฑุณูู "
            "ููุชุญุฏู. ููุงู ุฃูุถูุง ุชุญุฏูุงุช ุดูุฑูุฉ ููุตููุฉ ูุชุนุฒูุฒ ุงูุชูุงูุณูุฉ ุจูู ุงููุดุงุฑููู."
        ),
        "ุงูุฌูุงุฆุฒ": (
            "ุชูุฏู ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู ุฌูุงุฆุฒ ูููุฉ ูููุงุฆุฒูู ุนูู ูุณุชููุงุช ูุฎุชููุฉ. ุชุดูู ุงูุฌูุงุฆุฒ ุนูู ูุณุชูู "
            "ุงููุฏุงุฑุณ ูุงูุจูุฏุงูุ ูุฌูุงุฆุฒ ูุฑุฏูุฉ ููุทูุงุจุ ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฌุงุฆุฒุฉ ุงููุจุฑู ูุจุทู ุงูุชุญุฏู ุนูู ูุณุชูู "
            "ุงููุทู ุงูุนุฑุจู ุจูููุฉ 500 ุฃูู ุฏุฑูู ุฅูุงุฑุงุชู. ุงูุฌูุงุฆุฒ ุชุดูู ุฃูุถูุง ุฑุญูุงุช ุชุนููููุฉ ููุฑุตูุง ูููุดุงุฑูุฉ "
            "ูู ูุนุงููุงุช ุฏูููุฉ."
            "โข	ุงูุฌุงุฆุฒุฉ ุนูู ูุณุชูู ุงูุฏููุฉ 5000 ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุงูุทูุงุจ ูู ุงููุฑูุฒ ุงูุซุงูู ุฅูู ุงููุฑูุฒ ุงูุนุงุดุฑ 1500 ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุงูุทุงูุจ ุงูุฃูู ูู ุฐูู ุงูููู 3000 ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุงูุทุงูุจ ุงูุซุงูู ูุงูุซุงูุซ ูู ุฐูู ุงูููู 1000 ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุงูุทูุงุจ ุงููุงุฆุฒูู ุนูู ูุณุชูู ุงููุญุงูุธุฉ / ุงูููุทูุฉ ุงูุชุนููููุฉ 250 ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุงููุฏุฑุณุฉ ุงููุชููุฒุฉ ุนูู ูุณุชูู ุงููุทู ุงูุนุฑุจู ููููู ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุงููุฏุฑุณุฉ ุงููุชููุฒุฉ ุนูู ูุณุชูู ุงูุฏููุฉ 50 ุฃูู ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุฃูุถู ูุดุฑู ุนูู ูุณุชูู ุงููุทู ุงูุนุฑุจู 300 ุฃูู ุฏุฑูู ุงูุงุฑุงุชู"
            "โข	ุฌุงุฆุฒุฉ ุฃูุถู ูุดุฑู ุนูู ูุณุชูู ุงููุทู ุงูุนุฑุจู 300 ุฃูู ุฏุฑูู ุงูุงุฑุงุชู"
            
            
        ),
        "ูุฌููุนุฉ ุงูููุณุจูู": ("https://www.facebook.com/share/g/jW2H2JwENhDKrvJX/"),
        "ุชุญุฏู ูููู": await daily_challenge(context),
        "ุฏุฑุฏุดุฉ ุฐููุฉ": (
            "ููุชูุงุนู ูุน ุฑูุจูุช ุงูุฏุฑุฏุดุฉ ุงูุฐูู ุงูุฎุงุต ุจุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจูุ ููููู ุฒูุงุฑุฉ ุงูุฑุงุจุท ุงูุชุงูู: "
            "https://poe.com/ARC-ALQalyobia."
            "ุณูุฌูุจ ุงูุฑูุจูุช ุนูู ุงุณุชูุณุงุฑุงุชู ูููุฏู ูู ูุตุงุฆุญ ูุชูุตูุงุช "
            "ูุชุนุฒูุฒ ุชุฌุฑุจุชู ูู ุงูุชุญุฏู."
        ),
        "ุฅุญุตุงุฆูุงุช ุงููุฑุงุกุฉ": await show_reading_stats(context)
    }
    
    return responses.get(choice, "ุนุฐุฑูุงุ ุงูุฎูุงุฑ ุงูุฐู ุญุฏุฏุชู ุบูุฑ ูุชุงุญ. ูุฑุฌู ุงุฎุชูุงุฑ ุฃุญุฏ ุงูุฎูุงุฑุงุช ุงููุชุงุญุฉ.")


async def handle_book_recommendation(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    keyboard = [
        [InlineKeyboardButton("ุงุจุชุฏุงุฆูุฉ", callback_data='book_ุงุจุชุฏุงุฆูุฉ'),
         InlineKeyboardButton("ุงุนุฏุงุฏูุฉ", callback_data='book_ุงุนุฏุงุฏูุฉ'),
         InlineKeyboardButton("ุซุงูููุฉ", callback_data='book_ุซุงูููุฉ')]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text("ุงุฎุชุฑ ุงููุฑุญูุฉ ุงูุฏุฑุงุณูุฉ ููุญุตูู ุนูู ุชูุตูุฉ ูุชุงุจ:", reply_markup=reply_markup)
    return BOOK_RECOMMENDATION

async def book_recommendation(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    
    stage = query.data.split('_')[1]
    book = random.choice(books[stage])
    
    user_id = update.effective_user.id
    c.execute("SELECT current_book FROM users WHERE id = ?", (user_id,))
    current_book = c.fetchone()[0]
    
    related_books = [b for b in books[stage] if b['title'] != book['title'] and b['title'] != current_book]
    related_book = random.choice(related_books) if related_books else None
    
    message = f"ุฅููู ุงูุชุฑุงุญ ูุชุงุจ ูููุฑุญูุฉ {stage}:\n\n" \
              f"ุงููุชุงุจ: {book['title']}\n" \
              f"ุงููุคูู: {book['author']}"
    if related_book:
        message += f"\n\nูุฏ ูุนุฌุจู ุฃูุถูุง: {related_book['title']} ูู {related_book['author']}"
    
    keyboard = [
        [InlineKeyboardButton("ุงูุชุฑุงุญ ุขุฎุฑ", callback_data=f'book_{stage}')],
       
        [InlineKeyboardButton("ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ", callback_data='main_menu')]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    
    await query.edit_message_text(message, reply_markup=reply_markup)
    
    return CHOOSING

async def handle_rating(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    
    rating = query.data.split('_')[1]
    if rating == 'good':
        message = "ุดูุฑูุง ูุชููููู ุงูุฅูุฌุงุจู! ุณูุณุชูุฑ ูู ุชูุฏูู ุงูุชุฑุงุญุงุช ููุงุซูุฉ."
    else:
        message = "ูุฃุณู ูุนุฏู ุฅุนุฌุงุจู ุจุงูุงูุชุฑุงุญ. ุณูุญุงูู ุชุญุณูู ุงูุชุฑุงุญุงุชูุง ูู ุงููุณุชูุจู."
    
    await query.edit_message_text(message, reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def daily_challenge(context: ContextTypes.DEFAULT_TYPE) -> str:
    challenges = [
        "ุงูุฑุฃ 20 ุตูุญุฉ ุงูููู",
        "ุงูุชุจ ููุฎุตูุง ููุง ูุฑุฃุชู",
        "ุดุงุฑู ุงูุชุจุงุณูุง ุฃุนุฌุจู ูู ูุฑุงุกุชู ุงูููู",
        "ูุงูุด ูุง ูุฑุฃุชู ูุน ุตุฏูู",
        "ุงูุฑุฃ ูู ููุงู ูุฎุชูู ุนู ุงููุนุชุงุฏ"
    ]
    return f"ุชุญุฏู ุงูููู:\n\n{random.choice(challenges)}"

async def handle_reading_progress(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    context.user_data['expecting_pages'] = True
    await update.message.reply_text("ูู ุตูุญุฉ ูุฑุฃุช ุงููููุ", reply_markup=ReplyKeyboardRemove())
    return READING_PROGRESS

async def reading_progress(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    pages = update.message.text
    user_id = update.effective_user.id
    
    if pages.isdigit():
        date = datetime.now().strftime("%Y-%m-%d")
        c.execute("INSERT INTO reading_progress (user_id, date, pages) VALUES (?, ?, ?)", (user_id, date, int(pages)))
        conn.commit()
        
        await update.message.reply_text(
            f"ุชู ุชุณุฌูู ุชูุฏูู! ููุฏ ูุฑุฃุช {pages} ุตูุญุฉ ุงูููู. ุฃุญุณูุช!",
            reply_markup=get_main_menu_keyboard()
        )
    else:
        await update.message.reply_text("ุนุฐุฑูุงุ ูุฑุฌู ุฅุฏุฎุงู ุฑูู ุตุญูุญ.", reply_markup=get_main_menu_keyboard())
    context.user_data['expecting_pages'] = False
    return CHOOSING

async def start_quiz(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    question = random.choice(questions)
    context.user_data['current_question'] = question
    options = question['options']
    keyboard = [[InlineKeyboardButton(option, callback_data=f"quiz_{i}")] for i, option in enumerate(options)]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.effective_message.reply_text(f"ุงูุณุคุงู: {question['question']}", reply_markup=reply_markup)
    return QUIZ

async def handle_quiz_answer(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    
    selected_answer = int(query.data.split('_')[1])
    question = context.user_data['current_question']
    correct_answer = question['correct']
    
    if selected_answer == correct_answer:
        response = "ุฅุฌุงุจุฉ ุตุญูุญุฉ! ุฃุญุณูุช!"
    else:
        correct_option = question['options'][correct_answer]
        response = f"ููุฃุณูุ ุงูุฅุฌุงุจุฉ ุบูุฑ ุตุญูุญุฉ. ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ูู: {correct_option}"
    
    keyboard = [
        [InlineKeyboardButton("ุณุคุงู ุฌุฏูุฏ", callback_data='new_quiz')],
        [InlineKeyboardButton("ุงูุนูุฏุฉ ูููุงุฆูุฉ ุงูุฑุฆูุณูุฉ", callback_data='main_menu')]
    ]
    await query.edit_message_text(response, reply_markup=InlineKeyboardMarkup(keyboard))
    return CHOOSING

async def handle_book_review(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    context.user_data['expecting_book_review'] = True
    await update.message.reply_text("ูุง ูู ุงุณู ุงููุชุงุจ ุงูุฐู ุชุฑูุฏ ูุฑุงุฌุนุชูุ", reply_markup=ReplyKeyboardRemove())
    return BOOK_REVIEW

async def book_review(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    book_name = update.message.text
    context.user_data['current_book'] = book_name
    await update.message.reply_text(f"ุฑุงุฆุน! ุงูุขูุ ุงูุชุจ ูุฑุงุฌุนุชู ููุชุงุจ '{book_name}'.")
    return BOOK_REVIEW

async def handle_book_review_text(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    review = update.message.text
    book_name = context.user_data.get('current_book', "ูุชุงุจ ุบูุฑ ูุนุฑูู")
    user_id = update.effective_user.id
    
    c.execute("INSERT INTO book_reviews (user_id, book, review) VALUES (?, ?, ?)", (user_id, book_name, review))
    conn.commit()
    
    await update.message.reply_text(
        f"ุดูุฑูุง ููุดุงุฑูุฉ ูุฑุงุฌุนุชู ููุชุงุจ '{book_name}'!",
        reply_markup=get_main_menu_keyboard()
    )
    context.user_data['expecting_book_review'] = False
    return CHOOSING

async def show_reading_stats(context: ContextTypes.DEFAULT_TYPE) -> str:
    user_id = context.user_data.get('user_id')
    c.execute("SELECT SUM(pages), AVG(pages), MAX(pages), COUNT(DISTINCT date) FROM reading_progress WHERE user_id = ?", (user_id,))
    total_pages, avg_pages, max_pages, days_read = c.fetchone()
    
    if not total_pages:
        return "ูู ุชุณุฌู ุฃู ุชูุฏู ูู ุงููุฑุงุกุฉ ุจุนุฏ. ุงุจุฏุฃ ุจุชุณุฌูู ุตูุญุงุชู ุงูููู!"
    
    return f"ุฅุญุตุงุฆูุงุช ุงููุฑุงุกุฉ ุงูุฎุงุตุฉ ุจู:\n\n" \
           f"ุฅุฌูุงูู ุงูุตูุญุงุช ุงูููุฑูุกุฉ: {total_pages}\n" \
           f"ูุชูุณุท ุงูุตูุญุงุช ูููููุง: {avg_pages:.2f}\n" \
           f"ุฃูุจุฑ ุนุฏุฏ ุตูุญุงุช ูู ููู ูุงุญุฏ: {max_pages}\n" \
           f"ุนุฏุฏ ุฃูุงู ุงููุฑุงุกุฉ: {days_read}"

async def handle_reading_groups(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    keyboard = [
        [InlineKeyboardButton("ุฅูุดุงุก ูุฌููุนุฉ", callback_data='create_group')],
        [InlineKeyboardButton("ุงูุงูุถูุงู ููุฌููุนุฉ", callback_data='join_group')],
        [InlineKeyboardButton("ุนุฑุถ ุงููุฌููุนุงุช", callback_data='show_groups')]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text("ูุงุฐุง ุชุฑูุฏ ุฃู ุชูุนู ูุน ูุฌููุนุงุช ุงููุฑุงุกุฉุ", reply_markup=reply_markup)
    return READING_GROUP

async def create_reading_group(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    await query.message.reply_text("ูุง ูู ุงุณู ุงููุฌููุนุฉ ุงูุชู ุชุฑูุฏ ุฅูุดุงุกูุงุ")
    return CREATING_GROUP

async def save_reading_group(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    group_name = update.message.text
    c.execute("INSERT INTO reading_groups (name) VALUES (?)", (group_name,))
    group_id = c.lastrowid
    c.execute("INSERT INTO group_members (group_id, user_id) VALUES (?, ?)", (group_id, update.effective_user.id))
    conn.commit()
    await update.message.reply_text(f"ุชู ุฅูุดุงุก ูุฌููุนุฉ '{group_name}' ุจูุฌุงุญ!", reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def join_reading_group(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    c.execute("SELECT id, name FROM reading_groups")
    groups = c.fetchall()
    keyboard = [[InlineKeyboardButton(name, callback_data=f'join_{id}')] for id, name in groups]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.message.reply_text("ุงุฎุชุฑ ุงููุฌููุนุฉ ุงูุชู ุชุฑูุฏ ุงูุงูุถูุงู ุฅูููุง:", reply_markup=reply_markup)
    return JOINING_GROUP

async def handle_join_group(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    group_id = int(query.data.split('_')[1])
    c.execute("INSERT OR IGNORE INTO group_members (group_id, user_id) VALUES (?, ?)", (group_id, query.from_user.id))
    conn.commit()
    c.execute("SELECT name FROM reading_groups WHERE id = ?", (group_id,))
    group_name = c.fetchone()[0]
    await query.message.reply_text(f"ููุฏ ุงูุถููุช ุจูุฌุงุญ ุฅูู ูุฌููุนุฉ '{group_name}'!", reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def show_reading_groups(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    c.execute("SELECT name FROM reading_groups")
    groups = c.fetchall()
    group_list = "\n".join([group[0] for group in groups])
    await query.message.reply_text(f"ุงููุฌููุนุงุช ุงููุชุงุญุฉ:\n\n{group_list}")
    return CHOOSING

async def handle_reading_challenges(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    keyboard = [
        [InlineKeyboardButton("ุจุฏุก ุชุญุฏู ุฌุฏูุฏ", callback_data='start_challenge')],
        [InlineKeyboardButton("ุนุฑุถ ุงูุชุญุฏูุงุช ุงูุญุงููุฉ", callback_data='show_challenges')]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await update.message.reply_text("ูุงุฐุง ุชุฑูุฏ ุฃู ุชูุนู ูุน ุชุญุฏูุงุช ุงููุฑุงุกุฉุ", reply_markup=reply_markup)
    return CHALLENGE

async def start_reading_challenge(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    challenges = ["ูุฑุงุกุฉ ูุชุงุจ ูู ุฃุณุจูุน", "ูุฑุงุกุฉ 50 ุตูุญุฉ ูููููุง", "ูุฑุงุกุฉ 5 ูุชุจ ูู ุดูุฑ"]
    keyboard = [[InlineKeyboardButton(challenge, callback_data=f'challenge_{i}')] for i, challenge in enumerate(challenges)]
    reply_markup = InlineKeyboardMarkup(keyboard)
    await query.message.reply_text("ุงุฎุชุฑ ููุน ุงูุชุญุฏู:", reply_markup=reply_markup)
    return CHALLENGE

async def handle_challenge_choice(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    challenge_index = int(query.data.split('_')[1])
    challenges = ["ูุฑุงุกุฉ ูุชุงุจ ูู ุฃุณุจูุน", "ูุฑุงุกุฉ 50 ุตูุญุฉ ูููููุง", "ูุฑุงุกุฉ 5 ูุชุจ ูู ุดูุฑ"]
    selected_challenge = challenges[challenge_index]
    user_id = query.from_user.id
    start_date = datetime.now().strftime("%Y-%m-%d")
    end_date = (datetime.now() + timedelta(days=30)).strftime("%Y-%m-%d")
    c.execute("INSERT INTO challenges (user_id, challenge_type, start_date, end_date, goal, progress) VALUES (?, ?, ?, ?, ?, ?)",
              (user_id, selected_challenge, start_date, end_date, 1, 0))
    conn.commit()
    await query.message.reply_text(f"ุชู ุจุฏุก ุงูุชุญุฏู: {selected_challenge}")
    return CHOOSING

async def show_reading_challenges(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()
    user_id = query.from_user.id
    c.execute("SELECT challenge_type, start_date, end_date, goal, progress FROM challenges WHERE user_id = ?", (user_id,))
    challenges = c.fetchall()
    if challenges:
        challenge_list = "\n\n".join([f"ุงูุชุญุฏู: {challenge[0]}\nุชุงุฑูุฎ ุงูุจุฏุก: {challenge[1]}\nุชุงุฑูุฎ ุงูุงูุชูุงุก: {challenge[2]}\nุงููุฏู: {challenge[3]}\nุงูุชูุฏู: {challenge[4]}" for challenge in challenges])
        await query.message.reply_text(f"ุงูุชุญุฏูุงุช ุงูุญุงููุฉ:\n\n{challenge_list}")
    else:
        await query.message.reply_text("ููุณ ูุฏูู ุฃู ุชุญุฏูุงุช ุญุงููุฉ. ุฌุฑุจ ุจุฏุก ุชุญุฏู ุฌุฏูุฏ!")
    return CHOOSING

async def handle_book_summarization(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    await update.message.reply_text(
        "ูุชูุฎูุต ูุชุงุจ ูู 9 ุฃุณุทุฑุ ุงุชุจุน ูุฐู ุงูุฎุทูุงุช:\n\n"
        "1. ุงูุฑุฃ ุงููุชุงุจ ุจุนูุงูุฉ ูุญุฏุฏ ุงูุฃููุงุฑ ุงูุฑุฆูุณูุฉ.\n"
        "2. ุงูุชุจ ุฌููุฉ ูุงุญุฏุฉ ุชูุฎุต ุงูููุฑุฉ ุงูุฑุฆูุณูุฉ ูููุชุงุจ.\n"
        "3. ุญุฏุฏ 3-4 ููุงุท ุฑุฆูุณูุฉ ูุบุทููุง ุงููุชุงุจ.\n"
        "4. ุงูุชุจ ุฌููุฉ ุฃู ุฌููุชูู ููู ููุทุฉ ุฑุฆูุณูุฉ.\n"
        "5. ุงุฎุชู ุจุฌููุฉ ุชูุฎุต ุงูุฑุณุงูุฉ ุงูุนุงูุฉ ุฃู ุงูุงุณุชูุชุงุฌ ูู ุงููุชุงุจ.\n\n"
        "ุงูุขูุ ุฃุฏุฎู ุงุณู ุงููุชุงุจ ุงูุฐู ุชุฑูุฏ ุชูุฎูุตู:"
    )
    return SUMMARIZE_BOOK

async def summarize_book(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    book_name = update.message.text
    await update.message.reply_text(
        f"ุฑุงุฆุน! ุงูุขู ูู ุจุชูุฎูุต ูุชุงุจ '{book_name}' ูู 9 ุฃุณุทุฑ ูุญุฏ ุฃูุตู. "
        "ุชุฐูุฑ ุฃู ุชุฑูุฒ ุนูู ุงูุฃููุงุฑ ุงูุฑุฆูุณูุฉ ูุงูููุงุท ุงููููุฉ."
    )
    context.user_data['summarizing_book'] = book_name
    return SUMMARIZE_BOOK

async def save_book_summary(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    summary = update.message.text
    book_name = context.user_data.get('summarizing_book', "ูุชุงุจ ุบูุฑ ูุนุฑูู")
    user_id = update.effective_user.id
    
    c.execute("INSERT INTO book_reviews (user_id, book, review) VALUES (?, ?, ?)", (user_id, book_name, summary))
    conn.commit()
    
    await update.message.reply_text(
        f"ุดูุฑูุง ูุชูุฎูุตู ููุชุงุจ '{book_name}'! ุชู ุญูุธ ุงูููุฎุต ุจูุฌุงุญ.",
        reply_markup=get_main_menu_keyboard()
    )
    context.user_data.pop('summarizing_book', None)
    return CHOOSING

async def show_challenge_champions(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    champions = {
        "ุฃุจุทุงู ุงูุชุญุฏู ุงูุณุงุจููู:\n"
            "ุงูููุณู ุงูุณุงุจุน 2022-2023: ุขููุฉ ุงูููุตูุฑู (ุงูุฅูุงุฑุงุช) ูุนุจุฏ ุงููู ุงูุจุฑู (ูุทุฑ).\n"
            "ุงูููุณู ุงูุณุงุฏุณ 2021-2022: ุดุงู ุงูุจููุฑ (ุณูุฑูุง).\n"
            "ุงูููุณู ุงูุฎุงูุณ 2019-2020: ุนุจุฏ ุงููู ูุญูุฏ ูุฑุงุฏ ุงุจู ุฎูู (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุฑุงุจุน 2018-2019: ูุฏูู ุฃููุฑ ุงูุฒุจูุฑ ุนุจุฏ ุงูุฑุญูู (ุงูุณูุฏุงู).\n"
            "ุงูููุณู ุงูุซุงูุซ 2017-2018: ูุฑูู ูุญุณู ุงูุฌูู (ุงููุบุฑุจ).\n"
            "ุงูููุณู ุงูุซุงูู 2016-2017: ุนูุงู ุฑุงุฆุฏ ุดุฑูู (ููุณุทูู).\n"
            "ุงูููุณู ุงูุฃูู 2015-2016: ูุญูุฏ ุนุจุฏ ุงููู ูุฑุญ ุฌููุฏ (ุงูุฌุฒุงุฆุฑ).\n"
        "ูุดุฑููู ูุชููุฒูู:\n"
            "ุงูููุณู ุงูุณุงุจุน 2022-2023: ุณูุงูุฑ ุงูุณูุงุนู (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุณุงุฏุณ 2021-2022: ููุฑ ุงูุฌุจูุฑ (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุฎุงูุณ 2019-2020: ููุฒุฉ ุงูุบูุงุฉ (ุงูุฅูุงุฑุงุช).\n"
            "ุงูููุณู ุงูุฑุงุจุน 2018-2019: ุฃููุฑุฉ ูุญูุฏ ูุฌูุจ (ูุตุฑ).\n"
            "ุงูููุณู ุงูุซุงูุซ 2017-2018: ุนุงุฆุดุฉ ุงูุทููุฑูู (ุงูุณุนูุฏูุฉ).\n"
            "ุงูููุณู ุงูุซุงูู 2016-2017: ุญูุฑูุฉ ุงูุธู (ุงููุบุฑุจ).\n"
        "ูุฏุงุฑุณ ูุงุฆุฒุฉ.\n"
            "ุงูููุณู ุงูุณุงุจุน 2022-2023: ูุฏุฑุณุฉ ุงูููู ุนุจุฏ ุงููู ุงูุซุงูู ููุชููุฒ (ุงูุฃุฑุฏู).\n"
            "ุงูููุณู ุงูุณุงุฏุณ 2021-2022: ูุฏุฑุณุฉ ุงูุฑุคูุฉ ุงูุนุงูููุฉ (ุงูุฅูุงุฑุงุช).\n"
            "ุงูููุณู ุงูุฎุงูุณ 2019-2020: ูุฏุฑุณุฉ ุงูุดูุฎ ุฒุงูุฏ ุจู ุณูุทุงู (ุงูุณุนูุฏูุฉ).\n"
            "ุงูููุณู ุงูุฑุงุจุน 2018-2019: ูุฏุฑุณุฉ ุงูุจูุงุช ุงูุซุงูููุฉ (ุงูุณูุฏุงู).\n"
            "ุงูููุณู ุงูุซุงูุซ 2017-2018: ูุฏุฑุณุฉ ุงููุตุฑ (ุงููุบุฑุจ)."
        
    }

    champions_text = "ุฃุจุทุงู ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู:\n\n" + "\n\n".join(champions)
    await update.message.reply_text(champions_text, reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    text = update.message.text
    if text.lower() == 'ุฅูุบุงุก':
        return await cancel(update, context)
    
    if context.user_data.get('expecting_pages', False):
        context.user_data['expecting_pages'] = False
        return await reading_progress(update, context)
    
    if context.user_data.get('expecting_book_review', False):
        context.user_data['expecting_book_review'] = False
        return await handle_book_review_text(update, context)
    
    if context.user_data.get('summarizing_book', False):
        return await save_book_summary(update, context)
    
    # Handle smart chat
    if text.lower() == 'ุฏุฑุฏุดุฉ ุฐููุฉ':
        await update.message.reply_text(
            "ููุฏุฑุฏุดุฉ ุงูุฐููุฉุ ูุฑุฌู ุฒูุงุฑุฉ ุงูุฑุงุจุท ุงูุชุงูู:\n"
            "https://poe.com/ARC-ALQalyobia"
        )
        return CHOOSING
    
    # Handle general inquiries about the challenge
    if 'ุชุญุฏู ุงููุฑุงุกุฉ' in text or 'ุนู ุงููุณุงุจูุฉ' in text:
        await update.message.reply_text(
            "ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู ูู ุฃูุจุฑ ูุดุฑูุน ุนุฑุจู ุฃุทููู ุตุงุญุจ ุงูุณูู ุงูุดูุฎ ูุญูุฏ ุจู ุฑุงุดุฏ ุขู ููุชูู "
            "ูุชุดุฌูุน ุงููุฑุงุกุฉ ูุฏู ุงูุทูุงุจ ูู ุงูุนุงูู ุงูุนุฑุจู. ููุฏู ุงูุชุญุฏู ุฅูู ูุฑุงุกุฉ ุฃูุซุฑ ูู 50 ููููู ูุชุงุจ "
            "ุฎูุงู ูู ุนุงู ุฏุฑุงุณู."
        )
        return CHOOSING
    
    return await handle_choice(update, context)
async def cancel(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    await update.message.reply_text(
        "ุชู ุฅูุบุงุก ุงูุนูููุฉ ุงูุญุงููุฉ. ูู ููุงู ุดูุก ุขุฎุฑ ูููููู ูุณุงุนุฏุชู ุจูุ",
        reply_markup=get_main_menu_keyboard()
    )
    return CHOOSING
async def error_handler(update: object, context: ContextTypes.DEFAULT_TYPE) -> None:
    logger.error(msg="Exception while handling an update:", exc_info=context.error)

async def show_challenge_info(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    info_text = (
        "ูุนูููุงุช ุนู ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู:\n\n"
        "- ุงูุฑุคูุฉ: ุบุฑุณ ุญุจ ุงููุฑุงุกุฉ ูู ูููุณ ุงูุตุบุงุฑ.\n"
        "- ุงูุฑุณุงูุฉ: ุฅุญุฏุงุซ ููุถุฉ ูู ุงููุฑุงุกุฉ ูู ุฌููุน ุฃูุญุงุก ุงููุทู ุงูุนุฑุจู.\n"
        "- ุงูุฃูุฏุงู:\n"
        "  โข ุชูููุฉ ุงููุนู ุจูุงูุน ุงููุฑุงุกุฉ ุงูุนุฑุจู.\n"
        "  โข ุชุนุฒูุฒ ุงูุญุณ ุงููุทูู ูุงูุดุนูุฑ ุจุงูุงูุชูุงุก.\n"
        "  โข ูุดุฑ ููู ุงูุชุณุงูุญ ูุงูุงุนุชุฏุงู.\n"
        "  โข ุชูููู ุฌูู ูู ุงููุชููุฒูู ูุงููุจุฏุนูู.\n"
        "  โข ุชูุดูุท ุญุฑูุฉ ุงูุชุฃููู ูุงูุชุฑุฌูุฉ ูุงููุดุฑ.\n"
        "ูููุฒูุฏ ูู ุงููุนูููุงุชุ ูุฑุฌู ุฒูุงุฑุฉ ุงููููุน ุงูุฑุณูู ููุชุญุฏู."
    )
    await update.message.reply_text(info_text, reply_markup=get_main_menu_keyboard())
    return CHOOSING
async def handle_button(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    query = update.callback_query
    await query.answer()

    if query.data == 'main_menu':
        await query.message.reply_text("ุงูุนูุฏุฉ ุฅูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ", reply_markup=get_main_menu_keyboard())
        return CHOOSING
    elif query.data.startswith('book_'):
        return await book_recommendation(update, context)
    elif query.data.startswith('rate_'):
        return await handle_rating(update, context)
    elif query.data == 'new_quiz':
        return await start_quiz(update, context)
    elif query.data == 'create_group':
        return await create_reading_group(update, context)
    elif query.data == 'join_group':
        return await join_reading_group(update, context)
    elif query.data == 'show_groups':
        return await show_reading_groups(update, context)
    elif query.data == 'start_challenge':
        return await start_reading_challenge(update, context)
    elif query.data == 'show_challenges':
        return await show_reading_challenges(update, context)
    elif query.data.startswith('challenge_'):
        return await handle_challenge_choice(update, context)
    else:
        await query.message.reply_text("ุนุฐุฑูุงุ ูู ุฃููู ูุฐุง ุงูุงุฎุชูุงุฑ.")
        return CHOOSING

async def show_participation_steps(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    steps = (
        "ุฎุทูุงุช ุงููุดุงุฑูุฉ ูู ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู:\n\n"
        "1. ุงูุชูุงุตู ูุน ูุดุฑู ุงูุชุญุฏู ูู ูุฏุฑุณุชู ููุชุณุฌูู.\n"
        "2. ุงุณุชูุงู ุฌูุงุฒ ุงูุชุญุฏู ุงูุฎุงุต ุจู.\n"
        "3. ูุฑุงุกุฉ ุงููุชุจ ูุชูุฎูุตูุง ูู ุฌูุงุฒ ุงูุชุญุฏู.\n"
        "4. ุฅููุงู ูุฑุงุกุฉ 50 ูุชุงุจูุง ุฎูุงู ุงูุนุงู ุงูุฏุฑุงุณู.\n"
        "5. ุงููุดุงุฑูุฉ ูู ุงูุชุตููุงุช ุนูู ูุณุชูู ุงููุฏุฑุณุฉ ูุงูููุทูุฉ ูุงูุฏููุฉ.\n\n"
        "ุชุฐูุฑ: ููููู ุชุญููู ุฌูุงุฒุงุช ุงูุชุญุฏู ุจุตูุบุฉ PDF ูู ุงููููุน ุงูุฑุณูู ูููุณุงุจูุฉ."
    )
    await update.message.reply_text(steps, reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def show_challenge_prizes(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    prizes = (
        "ุฌูุงุฆุฒ ุชุญุฏู ุงููุฑุงุกุฉ ุงูุนุฑุจู:\n\n"
        "- ุงูุฌุงุฆุฒุฉ ุงูุฃููู ูุจุทู ุงูุชุญุฏู: 500,000 ุฏุฑูู ุฅูุงุฑุงุชู\n"
        "- ุฌุงุฆุฒุฉ ุงูุทุงูุจ ุงูุฃูู ุนูู ูุณุชูู ุงูุฏููุฉ: 100,000 ุฏุฑูู ุฅูุงุฑุงุชู\n"
        "- ุฌุงุฆุฒุฉ ุฃูุถู ูุดุฑู: 300,000 ุฏุฑูู ุฅูุงุฑุงุชู\n"
        "- ุฌุงุฆุฒุฉ ุงููุฏุฑุณุฉ ุงููุชููุฒุฉ: 1,000,000 ุฏุฑูู ุฅูุงุฑุงุชู\n\n"
        "ุจุงูุฅุถุงูุฉ ุฅูู ุฌูุงุฆุฒ ุฃุฎุฑู ูููุฑุงูุฒ ูู ุงูุซุงูู ุฅูู ุงูุนุงุดุฑ ูุฌูุงุฆุฒ ุฎุงุตุฉ ูุฐูู ุงูููู."
    )
    await update.message.reply_text(prizes, reply_markup=get_main_menu_keyboard())
    return CHOOSING

async def show_book_selection_criteria(update: Update, context: ContextTypes.DEFAULT_TYPE) -> int:
    criteria = (
        "ุดุฑูุท ุงุฎุชูุงุฑ ุงููุชุจ ูููุดุงุฑูุฉ ูู ุงูุชุญุฏู:\n\n"
        "- ุฃู ูููู ุงููุชุงุจ ุจุงููุบุฉ ุงูุนุฑุจูุฉ.\n"
        "- ุฃู ูููู ููุงุณุจูุง ููุณุชูู ุงูุทุงูุจ.\n"
        "- ุฃูุง ูููู ูู ุงููููุฌ ุงูุฏุฑุงุณู.\n"
        "- ุฃูุง ูููู ูุฑุฌุนูุง ุฃู ูุฌูุฉ ุฃู ุตุญููุฉ.\n"
        "- ุนุฏุฏ ุงูุตูุญุงุช ูุฎุชูู ุญุณุจ ุงููุฑุญูุฉ ุงูุฏุฑุงุณูุฉ (ูู 5 ุฅูู 51 ุตูุญุฉ ูุญุฏ ุฃุฏูู)."
    )
    await update.message.reply_text(criteria, reply_markup=get_main_menu_keyboard())
    return CHOOSING

def main() -> None:
    application = Application.builder().token(TELEGRAM_BOT_TOKEN).build()

    conv_handler = ConversationHandler(
        entry_points=[CommandHandler('start', start)],
        states={
            CHOOSING: [
                CallbackQueryHandler(handle_button),
                MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message),
            ],
            BOOK_RECOMMENDATION: [
                CallbackQueryHandler(book_recommendation)
            ],
            READING_PROGRESS: [
                MessageHandler(filters.TEXT & ~filters.COMMAND, reading_progress)
            ],
            QUIZ: [
                CallbackQueryHandler(handle_quiz_answer)
            ],
            BOOK_REVIEW: [
                MessageHandler(filters.TEXT & ~filters.COMMAND, handle_book_review_text)
            ],
            READING_GROUP: [
                CallbackQueryHandler(handle_button)
            ],
            CHALLENGE: [
                CallbackQueryHandler(handle_button)
            ],
            CREATING_GROUP: [
                MessageHandler(filters.TEXT & ~filters.COMMAND, save_reading_group)
            ],
            JOINING_GROUP: [
                CallbackQueryHandler(handle_join_group)
            ],
            SUMMARIZE_BOOK: [
                MessageHandler(filters.TEXT & ~filters.COMMAND, save_book_summary)
            ]
        },
        fallbacks=[CommandHandler('cancel', cancel)]
    )

    application.add_handler(conv_handler)
    application.add_handler(CommandHandler('help', help_command))
    application.add_handler(CommandHandler('info', show_challenge_info))
    application.add_handler(CommandHandler('participate', show_participation_steps))
    application.add_handler(CommandHandler('prizes', show_challenge_prizes))
    application.add_handler(CommandHandler('book_criteria', show_book_selection_criteria))
    application.add_handler(CommandHandler('champions', show_challenge_champions))
    application.add_error_handler(error_handler)
    application.run_polling()
if __name__ == '__main__':
    main()